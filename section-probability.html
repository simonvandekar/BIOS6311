<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Probability | BIOS6311: Principles of Modern Biostatistics</title>
  <meta name="description" content="2 Probability | BIOS6311: Principles of Modern Biostatistics" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Probability | BIOS6311: Principles of Modern Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Probability | BIOS6311: Principles of Modern Biostatistics" />
  
  
  

<meta name="author" content="Simon Vandekar" />


<meta name="date" content="2023-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-r-and-how-to-follow-along-in-this-class.html"/>

<!-- HEAD_CONTENT -->


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html"><i class="fa fa-check"></i>Bios 6311 Principles of Modern Biostatistics</a>
<ul>
<li class="chapter" data-level="0.1" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-syllabus"><i class="fa fa-check"></i><b>0.1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-overview"><i class="fa fa-check"></i><b>0.1.1</b> Overview</a></li>
<li class="chapter" data-level="0.1.2" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-goal"><i class="fa fa-check"></i><b>0.1.2</b> Goal</a></li>
<li class="chapter" data-level="0.1.3" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-datasets"><i class="fa fa-check"></i><b>0.1.3</b> Datasets</a></li>
<li class="chapter" data-level="0.1.4" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-homework"><i class="fa fa-check"></i><b>0.1.4</b> Homework</a></li>
<li class="chapter" data-level="0.1.5" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-exams-and-quizzes"><i class="fa fa-check"></i><b>0.1.5</b> Exams and Quizzes</a></li>
<li class="chapter" data-level="0.1.6" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-class"><i class="fa fa-check"></i><b>0.1.6</b> Class</a></li>
<li class="chapter" data-level="0.1.7" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-lab"><i class="fa fa-check"></i><b>0.1.7</b> Lab</a></li>
<li class="chapter" data-level="0.1.8" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-text"><i class="fa fa-check"></i><b>0.1.8</b> Text</a></li>
<li class="chapter" data-level="0.1.9" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-class-resources"><i class="fa fa-check"></i><b>0.1.9</b> Class resources</a></li>
<li class="chapter" data-level="0.1.10" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-diversity-and-inclusion"><i class="fa fa-check"></i><b>0.1.10</b> Diversity and inclusion:</a></li>
<li class="chapter" data-level="0.1.11" data-path="section-bios-6311-principles-of-modern-biostatistics.html"><a href="section-bios-6311-principles-of-modern-biostatistics.html#section-course-outline"><i class="fa fa-check"></i><b>0.1.11</b> Course outline</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-glossaryjargon.html"><a href="section-glossaryjargon.html"><i class="fa fa-check"></i>Glossary/Jargon</a></li>
<li class="chapter" data-level="1" data-path="section-r-and-how-to-follow-along-in-this-class.html"><a href="section-r-and-how-to-follow-along-in-this-class.html"><i class="fa fa-check"></i><b>1</b> <code>R</code> and how to follow-along in this class</a></li>
<li class="chapter" data-level="2" data-path="section-probability.html"><a href="section-probability.html"><i class="fa fa-check"></i><b>2</b> Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-probability.html"><a href="section-probability.html#section-probability-review"><i class="fa fa-check"></i><b>2.1</b> Probability review</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="section-probability.html"><a href="section-probability.html#section-objectives"><i class="fa fa-check"></i><b>2.1.1</b> Objectives</a></li>
<li class="chapter" data-level="2.1.2" data-path="section-probability.html"><a href="section-probability.html#section-administrative-stuff"><i class="fa fa-check"></i><b>2.1.2</b> Administrative stuff</a></li>
<li class="chapter" data-level="2.1.3" data-path="section-probability.html"><a href="section-probability.html#section-types-of-data"><i class="fa fa-check"></i><b>2.1.3</b> Types of data</a></li>
<li class="chapter" data-level="2.1.4" data-path="section-probability.html"><a href="section-probability.html#section-random-variables"><i class="fa fa-check"></i><b>2.1.4</b> Random variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-probability.html"><a href="section-probability.html#section-cdfs-pdfs-quantile-functions"><i class="fa fa-check"></i><b>2.2</b> CDFs, PDFs, quantile functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="section-probability.html"><a href="section-probability.html#section-objectives-1"><i class="fa fa-check"></i><b>2.2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-probability.html"><a href="section-probability.html#section-pdfs-and-cdfs-and-quantile-functions"><i class="fa fa-check"></i><b>2.2.2</b> PDFs and CDFs (and quantile functions)</a></li>
<li class="chapter" data-level="2.2.3" data-path="section-probability.html"><a href="section-probability.html#section-expectations"><i class="fa fa-check"></i><b>2.2.3</b> Expectations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-probability.html"><a href="section-probability.html#section-expectations-etc."><i class="fa fa-check"></i><b>2.3</b> Expectations etc.</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="section-probability.html"><a href="section-probability.html#section-more-on-expectations"><i class="fa fa-check"></i><b>2.3.1</b> More on expectations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="section-probability.html"><a href="section-probability.html#section-multivariate-random-variables"><i class="fa fa-check"></i><b>2.4</b> Multivariate random variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="section-probability.html"><a href="section-probability.html#section-distribution-functions"><i class="fa fa-check"></i><b>2.4.1</b> Distribution functions</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-probability.html"><a href="section-probability.html#section-marginal-probability"><i class="fa fa-check"></i><b>2.4.2</b> Marginal probability</a></li>
<li class="chapter" data-level="2.4.3" data-path="section-probability.html"><a href="section-probability.html#section-conditional-distribution"><i class="fa fa-check"></i><b>2.4.3</b> Conditional distribution</a></li>
<li class="chapter" data-level="2.4.4" data-path="section-probability.html"><a href="section-probability.html#section-examples"><i class="fa fa-check"></i><b>2.4.4</b> Examples</a></li>
<li class="chapter" data-level="2.4.5" data-path="section-probability.html"><a href="section-probability.html#section-conditional-means-and-variances"><i class="fa fa-check"></i><b>2.4.5</b> Conditional means and variances</a></li>
<li class="chapter" data-level="2.4.6" data-path="section-probability.html"><a href="section-probability.html#section-properties-of-expectation-for-two-random-variables"><i class="fa fa-check"></i><b>2.4.6</b> Properties of expectation for two random variables</a></li>
<li class="chapter" data-level="2.4.7" data-path="section-probability.html"><a href="section-probability.html#section-independence"><i class="fa fa-check"></i><b>2.4.7</b> Independence</a></li>
<li class="chapter" data-level="2.4.8" data-path="section-probability.html"><a href="section-probability.html#section-covariance-and-dependence"><i class="fa fa-check"></i><b>2.4.8</b> Covariance and dependence</a></li>
<li class="chapter" data-level="2.4.9" data-path="section-probability.html"><a href="section-probability.html#section-properties-of-variances-of-sums"><i class="fa fa-check"></i><b>2.4.9</b> Properties of variances of sums</a></li>
<li class="chapter" data-level="2.4.10" data-path="section-probability.html"><a href="section-probability.html#section-law-of-total-expectation"><i class="fa fa-check"></i><b>2.4.10</b> Law of total expectation</a></li>
<li class="chapter" data-level="2.4.11" data-path="section-probability.html"><a href="section-probability.html#section-law-of-total-variance"><i class="fa fa-check"></i><b>2.4.11</b> Law of total variance</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-probability.html"><a href="section-probability.html#section-parameters-estimates-and-estimators"><i class="fa fa-check"></i><b>2.5</b> Parameters, estimates, and estimators</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="section-probability.html"><a href="section-probability.html#section-objectives-2"><i class="fa fa-check"></i><b>2.5.1</b> Objectives</a></li>
<li class="chapter" data-level="2.5.2" data-path="section-probability.html"><a href="section-probability.html#section-statistics-is-a-way-to-learn-about-the-world-from-a-data-set"><i class="fa fa-check"></i><b>2.5.2</b> Statistics is a way to learn about the world from a data set</a></li>
<li class="chapter" data-level="2.5.3" data-path="section-probability.html"><a href="section-probability.html#section-a-random-sample-for-the-alcohol-question"><i class="fa fa-check"></i><b>2.5.3</b> A random sample for the alcohol question</a></li>
<li class="chapter" data-level="2.5.4" data-path="section-probability.html"><a href="section-probability.html#section-estimates"><i class="fa fa-check"></i><b>2.5.4</b> Estimates</a></li>
<li class="chapter" data-level="2.5.5" data-path="section-probability.html"><a href="section-probability.html#section-estimators"><i class="fa fa-check"></i><b>2.5.5</b> Estimators</a></li>
<li class="chapter" data-level="2.5.6" data-path="section-probability.html"><a href="section-probability.html#section-properties-of-estimators"><i class="fa fa-check"></i><b>2.5.6</b> Properties of estimators</a></li>
<li class="chapter" data-level="2.5.7" data-path="section-probability.html"><a href="section-probability.html#section-bias-variance-and-mse-of-the-proportion-estimator"><i class="fa fa-check"></i><b>2.5.7</b> Bias, variance, and MSE of the proportion estimator</a></li>
<li class="chapter" data-level="2.5.8" data-path="section-probability.html"><a href="section-probability.html#section-nsduh-example-of-bias-variance-and-mse"><i class="fa fa-check"></i><b>2.5.8</b> NSDUH: example of bias, variance, and MSE</a></li>
<li class="chapter" data-level="2.5.9" data-path="section-probability.html"><a href="section-probability.html#section-parameters-estimators-estimates"><i class="fa fa-check"></i><b>2.5.9</b> Parameters, Estimators, Estimates</a></li>
<li class="chapter" data-level="2.5.10" data-path="section-probability.html"><a href="section-probability.html#section-example-for-today-multiplexed-immunofluorescence-mif-microscopy"><i class="fa fa-check"></i><b>2.5.10</b> Example for today: multiplexed immunofluorescence (mIF) microscopy</a></li>
<li class="chapter" data-level="2.5.11" data-path="section-probability.html"><a href="section-probability.html#section-mif-imaging-in-a-statistical-framework"><i class="fa fa-check"></i><b>2.5.11</b> mIF imaging in a statistical framework</a></li>
<li class="chapter" data-level="2.5.12" data-path="section-probability.html"><a href="section-probability.html#section-a-gamma-model-for-beta-catenin-concentration"><i class="fa fa-check"></i><b>2.5.12</b> A Gamma model for Beta-catenin concentration</a></li>
<li class="chapter" data-level="2.5.13" data-path="section-probability.html"><a href="section-probability.html#section-mxif-example-estimators"><i class="fa fa-check"></i><b>2.5.13</b> MxIF example: Estimators</a></li>
<li class="chapter" data-level="2.5.14" data-path="section-probability.html"><a href="section-probability.html#section-concept-of-simulation-study"><i class="fa fa-check"></i><b>2.5.14</b> Concept of simulation study</a></li>
<li class="chapter" data-level="2.5.15" data-path="section-probability.html"><a href="section-probability.html#section-simulation-study"><i class="fa fa-check"></i><b>2.5.15</b> Simulation study</a></li>
<li class="chapter" data-level="2.5.16" data-path="section-probability.html"><a href="section-probability.html#section-assessing-estimators-in-the-homework"><i class="fa fa-check"></i><b>2.5.16</b> Assessing estimators in the homework</a></li>
<li class="chapter" data-level="2.5.17" data-path="section-probability.html"><a href="section-probability.html#section-mxif-example-estimate"><i class="fa fa-check"></i><b>2.5.17</b> MxIF example: Estimate</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOS6311: Principles of Modern Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-probability" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Probability<a href="section-probability.html#section-probability" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section-probability-review" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Probability review<a href="section-probability.html#section-probability-review" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-objectives" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Objectives<a href="section-probability.html#section-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this meeting we will:</p>
<ul>
<li>Introductions</li>
<li>Review some probability notation (e.g. PMF, Expectations)</li>
<li>Use Bernoulli random variables to study proportions</li>
<li>Define Estimators and learn to compute values assess estimators</li>
</ul>
<div class="tutorial-exercise" data-label="filter1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>insurance</code></pre>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div id="section-administrative-stuff" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Administrative stuff<a href="section-probability.html#section-administrative-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Introductions
<ul>
<li>How did you get interested in statistics?</li>
<li>What do you do for fun?</li>
</ul></li>
<li>Syllabus</li>
</ol>
</div>
<div id="section-types-of-data" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Types of data<a href="section-probability.html#section-types-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Continuous</li>
<li>Categorical</li>
<li>Ordinal</li>
</ul>
<p>Examples:</p>
<ul>
<li>Brain volume</li>
<li>Diagnosis</li>
<li>Symptom rating scale (1-7)</li>
<li>Coin flip</li>
<li>Proportion of heads in <span class="math inline">\(N\)</span> flips</li>
<li>Proportion of time spent sleeping each week</li>
</ul>
</div>
<div id="section-random-variables" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Random variables<a href="section-probability.html#section-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Random variables are the key player in statistics and are often used to describe the process by which data arise.</p>
<div id="section-probability-notation" class="section level4 hasAnchor" number="2.1.4.1">
<h4><span class="header-section-number">2.1.4.1</span> Probability notation<a href="section-probability.html#section-probability-notation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Blackboard P is probability, <span class="math inline">\(\mathbb{P}(X=x)\)</span>, means the probability the random variable <span class="math inline">\(X\)</span> is equal to the nonrandom value <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(\sim\)</span> “is distributed as”</li>
<li>Probability mass function (PMF; loose definition is it assigns probabilities to values for a given random variable)</li>
<li>Continuous/Discrete random variables</li>
<li>A random variable does not have a value in itself… We don’t usually talk about <span class="math inline">\(X=0.5\)</span>, but <span class="math inline">\(\mathbb{P}(X=0.5)\)</span>.</li>
</ul>
<div id="section-bernoulli-example" class="section level5 hasAnchor" number="2.1.4.1.1">
<h5><span class="header-section-number">2.1.4.1.1</span> Bernoulli example<a href="section-probability.html#section-bernoulli-example" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>Something that takes only two values can be described with a Bernoulli random variable.
<ul>
<li>Coin flip</li>
<li>Diagnosis</li>
</ul></li>
<li>For <span class="math inline">\(X\sim \text{Be}(\pi)\)</span>: X is distributed as <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli</a>, with parameter <span class="math inline">\(\pi \in (0,1)\)</span>, e.g. <span class="math inline">\(\pi=0.25\)</span>.</li>
<li><span class="math inline">\(\mathbb{P}(X = x) = \pi^x(1-\pi)^{(1-x)}\)</span>. That is the probability mass function (PMF) of a Bernoulli random variable</li>
<li>Common notation is <span class="math inline">\(f_X(x)\)</span> is the PMF of the random variable <span class="math inline">\(X\)</span>. In this case <span class="math inline">\(f_X(x):=\pi^x(1-\pi)^{(1-x)}\)</span>.</li>
<li><span class="math inline">\(:=\)</span> notation means “is defined by.”</li>
</ul>
</div>
</div>
<div id="section-probability-axioms" class="section level4 hasAnchor" number="2.1.4.2">
<h4><span class="header-section-number">2.1.4.2</span> Probability axioms<a href="section-probability.html#section-probability-axioms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have an intuitive understanding of the basic axioms of probability.</p>
<ul>
<li>An event <span class="math inline">\(E\)</span> is something that can occur, e.g. head or tails.</li>
<li><span class="math inline">\(F\)</span> is the collection of all events e.g. <span class="math inline">\(F = \{ \{0\}, \{1\} \}\)</span>.</li>
<li>Let <span class="math inline">\(\Omega = {0,1}\)</span> be union of all possible events</li>
</ul>
<p>The (Kolmogorov) axioms are</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{P}(X\in E) \ge 0\)</span> – probability is positive.</li>
<li><span class="math inline">\(\mathbb{P}(X\in \Omega) = 1\)</span> – probabilities sum to 1.</li>
<li>For disjoint sets <span class="math inline">\(E_1 \cap E_2 = \varnothing\)</span>, <span class="math inline">\(\mathbb{P}(E_1 \cup E_2) = \mathbb{P}(E_1) + \mathbb{P}(E_2)\)</span>.</li>
</ol>
</div>
<div id="section-why-use-probabilities-for-data" class="section level4 hasAnchor" number="2.1.4.3">
<h4><span class="header-section-number">2.1.4.3</span> Why use probabilities for data?<a href="section-probability.html#section-why-use-probabilities-for-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Intuitive and communicable explanation?</li>
<li>Table below from <a href="https://chessintheair.com/the-risk-of-dying-doing-what-we-love/">Chess in the air</a></li>
</ul>
<center>
<div class="float" id="section-id">
<img src="figures/The-Risk-of-Dying-Doing-What-We-Love-1.png" class="class" style="width:75.0%" alt="Risk of dying" />
<div class="figcaption">Risk of dying</div>
</div>
</div>
<div id="section-multinomial-example" class="section level4 hasAnchor" number="2.1.4.4">
<h4><span class="header-section-number">2.1.4.4</span> Multinomial example<a href="section-probability.html#section-multinomial-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>A die is an example of a multinomial distribution</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb3-1"><a href="section-probability.html#section-cb3-1" tabindex="-1"></a>die <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">&#39;X&#39;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">&#39;P(X)&#39;</span><span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&#39;$</span><span class="sc">\\</span><span class="st">pi_&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">&#39;$&#39;</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="section-cb3-2"><a href="section-probability.html#section-cb3-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(die)</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="left">P(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left"><span class="math inline">\(\pi_1\)</span></td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left"><span class="math inline">\(\pi_2\)</span></td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left"><span class="math inline">\(\pi_3\)</span></td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left"><span class="math inline">\(\pi_4\)</span></td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left"><span class="math inline">\(\pi_5\)</span></td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left"><span class="math inline">\(\pi_6\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Can also think about statements like <span class="math inline">\(\mathbb{P}(X\le x)\)</span></li>
<li>This is a sum over probabilities corresponding to possible values of <span class="math inline">\(X\)</span>.</li>
<li>Missing probabilities are called parameters</li>
</ul>
<p>e.g. x = 2
<span class="math display">\[
\sum_{i=1}^2 \mathbb{P}(X=i) = 1/3
\]</span></p>
</div>
<div id="section-wordle-multinomial-example" class="section level4 hasAnchor" number="2.1.4.5">
<h4><span class="header-section-number">2.1.4.5</span> Wordle Multinomial example<a href="section-probability.html#section-wordle-multinomial-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Multinomial can be used for distributions of other things</li>
<li>E.g. Wordle scores. The probability of getting the Wordle in a certain number of guesses.</li>
<li>Also 6 (or one more) possible values.</li>
<li>Same family of distribution as the die, except with different <em>parameters</em></li>
</ul>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(Y=\)</span>Number of tries</th>
<th align="center"><span class="math inline">\(P(Y)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="center">0.28</td>
</tr>
<tr class="even">
<td>4</td>
<td align="center">0.40</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="center">0.18</td>
</tr>
<tr class="even">
<td>6</td>
<td align="center">0.11</td>
</tr>
<tr class="odd">
<td>7</td>
<td align="center">??</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb4-1"><a href="section-probability.html#section-cb4-1" tabindex="-1"></a>wordle <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">7</span>)</span>
<span id="section-cb4-2"><a href="section-probability.html#section-cb4-2" tabindex="-1"></a><span class="co">#wordle/sum(wordle)</span></span>
<span id="section-cb4-3"><a href="section-probability.html#section-cb4-3" tabindex="-1"></a><span class="co">#round(wordle/sum(wordle), 2)</span></span></code></pre></div>
</details>
<center>
<div class="float" id="section-id">
<img src="figures/wordle.jpg" class="class" style="width:25.0%" alt="Wordle results" />
<div class="figcaption">Wordle results</div>
</div>
</div>
<div id="section-normal-example" class="section level4 hasAnchor" number="2.1.4.6">
<h4><span class="header-section-number">2.1.4.6</span> Normal example<a href="section-probability.html#section-normal-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>The normal density has two parameters <span class="math inline">\(\mu, \sigma\)</span> is
<span class="math display">\[
\mathbb{P}(X\le x) = \int_{-\infty}^x (2\pi\sigma^2)^{-1/2} \exp\left\{-\frac{1}{2\sigma^2}(z-\mu)^2 \right\}dz
\]</span></p></li>
<li><p>Probabilities of sets <span class="math inline">\(\mathbb{P}(X \in E)\)</span>, where <span class="math inline">\(E = (-\infty, -1.96) \cup (1.96, \infty)\)</span>.</p></li>
<li><p>Probability <span class="math inline">\(X=x\)</span>?</p></li>
</ul>
<!-- #### Properties of probabilities -->
<!-- The Kolmogorov axioms describe the rules probability has to follow. Informally, they are -->
<!-- 1. $\P(X \in E) \ge 0$ -->
<!-- 2. If $E$ is the whole domain of $X$, then $\P(X\in E) = 1$ -->
<!-- 3. For a bunch of sets that are disjoint $E_1, \ldots, E_K$, then $\P\left(X\in \bigcup_{k=1}^K E_k\right) = \sum_{k=1}^K \P(X \in E_k)$ -->
<p>Examples:</p>
<ol start="2" style="list-style-type: decimal">
<li>Multinomial – after a rolling a die, it has to land on one of them. Normal, <span class="math inline">\(E=(-\infty,\infty)\)</span>.</li>
<li>If not disjoint, then adding some probabilities twice. Multinomial <span class="math inline">\(\{1,2,3 \}, \{4,3\}\)</span></li>
</ol>
</div>
</div>
</div>
<div id="section-cdfs-pdfs-quantile-functions" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> CDFs, PDFs, quantile functions<a href="section-probability.html#section-cdfs-pdfs-quantile-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-objectives-1" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Objectives<a href="section-probability.html#section-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Today we will:</p>
<ul>
<li>Talk more about CDFs, PDFs, and quantile functions</li>
<li>Introduce Expectations (means)</li>
</ul>
</div>
<div id="section-pdfs-and-cdfs-and-quantile-functions" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> PDFs and CDFs (and quantile functions)<a href="section-probability.html#section-pdfs-and-cdfs-and-quantile-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="section-cdfs" class="section level4 hasAnchor" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> CDFs<a href="section-probability.html#section-cdfs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The cumulative distribution function (CDF), <span class="math inline">\(F(x)\)</span>, for a random variable <span class="math inline">\(X\)</span> is a function that satisfies
<span class="math display">\[
F(x) = \mathbb{P}(X \le x).
\]</span>
They are usually functions of parameters. Here are some examples.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="index_files/figure-html/unnamed-chunk-4-1.png" alt="Some distribution functions." width="960" />
<p class="caption">
Figure 2.1: Some distribution functions.
</p>
</div>
<p>For discrete random variables the derivative of the CDF does not exist because it is a step function, but the probability mass function is the amount the CDF jumps up at that location, heuristically we can define it as
<span class="math display">\[
f(x) = F(x+\Delta x) - F(x),
\]</span>
for an infinitesimal value <span class="math inline">\(\Delta x\)</span>.</p>
<div id="section-wordle-cdf-example" class="section level5 hasAnchor" number="2.2.2.1.1">
<h5><span class="header-section-number">2.2.2.1.1</span> Wordle CDF example<a href="section-probability.html#section-wordle-cdf-example" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(Y=\)</span>Number of tries</th>
<th align="center"><span class="math inline">\(P(Y|\text{Simon})\)</span></th>
<th align="center"><span class="math inline">\(P(Y|\text{Lillie})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="center">0.03</td>
<td align="center">0.05</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="center">0.28</td>
<td align="center">0.24</td>
</tr>
<tr class="even">
<td>4</td>
<td align="center">0.40</td>
<td align="center">0.44</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="center">0.18</td>
<td align="center">0.19</td>
</tr>
<tr class="even">
<td>6</td>
<td align="center">0.11</td>
<td align="center">0.08</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb5-1"><a href="section-probability.html#section-cb5-1" tabindex="-1"></a>wordle1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">7</span>)</span>
<span id="section-cb5-2"><a href="section-probability.html#section-cb5-2" tabindex="-1"></a>wordle2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">7</span>, <span class="dv">3</span>)</span>
<span id="section-cb5-3"><a href="section-probability.html#section-cb5-3" tabindex="-1"></a>wordle1 <span class="ot">=</span> <span class="fu">cumsum</span>(wordle1<span class="sc">/</span><span class="fu">sum</span>(wordle1))</span>
<span id="section-cb5-4"><a href="section-probability.html#section-cb5-4" tabindex="-1"></a>wordle2 <span class="ot">=</span> <span class="fu">cumsum</span>(wordle2<span class="sc">/</span><span class="fu">sum</span>(wordle2))</span>
<span id="section-cb5-5"><a href="section-probability.html#section-cb5-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="section-cb5-6"><a href="section-probability.html#section-cb5-6" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">c</span>(<span class="dv">0</span>,wordle1, <span class="dv">1</span>), <span class="at">main=</span><span class="st">&#39;Wordle CDFs&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;P(X&lt;=x)&#39;</span>)</span>
<span id="section-cb5-7"><a href="section-probability.html#section-cb5-7" tabindex="-1"></a><span class="fu">points</span>(x, <span class="fu">c</span>(<span class="dv">0</span>,wordle2, <span class="dv">1</span>), <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="288" /></p>
<center>
<img src="figures/wordle.jpg" id="section-id" class="class" style="width:25.0%" alt="Wordle results" />
<img src="figures/wordle_lillie.jpg" id="section-id" class="class" style="width:25.0%" alt="Wordle results" />
</center>
</div>
</div>
<div id="section-pdfs" class="section level4 hasAnchor" number="2.2.2.2">
<h4><span class="header-section-number">2.2.2.2</span> PDFs<a href="section-probability.html#section-pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The PDF (probability density function) is the derivative of the CDF and often denoted with a lower case letter <span class="math inline">\(f(x)\)</span>.
For discrete random variables the PDF is call the PMF (probability mass function).</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="index_files/figure-html/unnamed-chunk-6-1.png" alt="Corresponding density functions." width="960" />
<p class="caption">
Figure 2.2: Corresponding density functions.
</p>
</div>
</div>
<div id="section-pdfs-continued" class="section level4 flexbox vcenter hasAnchor" number="2.2.2.3">
<h4><span class="header-section-number">2.2.2.3</span> PDFs continued<a href="section-probability.html#section-pdfs-continued" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The PDF can conceptually be thought of as <span class="math inline">\(\mathbb{P}(X=x)\)</span>, for PMFs, that’s exactly what it is. But, for continuous random variables the probability they take any value is equal to zero.
These CDFs and PDFs are functions with parameters:
<span class="math display">\[
\begin{align*}
\text{Normal: }&amp; f(x; \mu, \sigma^2) = (2\pi\sigma^2)^{-1/2} \exp\left\{-\frac{1}{2\sigma^2}(x-\mu)^2 \right\} \\
\text{Gamma: }&amp; f(x; \alpha, \beta)  =  \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x} \\
\text{Poisson: }&amp; f(x; \lambda)  =  \frac{\lambda^k\ e^{-\lambda}}{k!} \\
\end{align*}
\]</span></p>
<p>The CDF and PDF are useful because we never know what values the random variable will take, so we can integrate the PDF or use the CDF to figure out where they are most likely to fall.</p>
</div>
<div id="section-quantile-functions" class="section level4 flexbox vcenter hasAnchor" number="2.2.2.4">
<h4><span class="header-section-number">2.2.2.4</span> Quantile functions<a href="section-probability.html#section-quantile-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The quantile function is the inverse of the CDF.</p>
<ul>
<li>For a given probability <span class="math inline">\(p\)</span>, it spits out a value <span class="math inline">\(Q(p)\)</span> such that that <span class="math inline">\(F(Q(p)) = p\)</span>.</li>
<li>The interpretation is that for a given probability <span class="math inline">\(p\)</span>, There’s a <span class="math inline">\(p\)</span> percent probability that the random variable will be below <span class="math inline">\(Q(p)\)</span>.</li>
<li>Sometimes, it’s possible to find the quantile function explicitly, but many times it isn’t.</li>
</ul>
</div>
</div>
<div id="section-expectations" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Expectations<a href="section-probability.html#section-expectations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="section-overview-1" class="section level4 hasAnchor" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Overview<a href="section-probability.html#section-overview-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Many things we care about about a random variable are expectations.
The expectation is an “operator” on a random variable, meaning it takes function of a random variable <span class="math inline">\(g(X)\)</span> for a (somewhat) arbitrary function <span class="math inline">\(g\)</span> and is defined by
<span class="math display">\[
\mathbb{E} g(X) = \int_{\mathcal{X}} g(x) p(x) dx,
\]</span>
where <span class="math inline">\(p(x)\)</span> is the density function of <span class="math inline">\(X\)</span> and the <span class="math inline">\(\mathcal{X}\)</span> subscript is to denote that we are integrating over the domain of values <span class="math inline">\(X\)</span> can take.</p>
</div>
<div id="section-great-expectations" class="section level4 hasAnchor" number="2.2.3.2">
<h4><span class="header-section-number">2.2.3.2</span> Great expectations<a href="section-probability.html#section-great-expectations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The mean is the most common expectation
<span class="math display">\[
\mathbb{E} X = \int_{\mathcal{X}} x p(x) dx.
\]</span></p>
<ul>
<li>The integral notation is in the sense of “real analysis” type integrals that can refer to sums or integrals. This is to emphasize that the definition is the same with continuous or discrete random variables.</li>
</ul>
<p>Another great expectation is the variance
<span class="math display">\[
\text{Var}(X) = \mathbb{E} (X - \mathbb{E}X)^2 = \mathbb{E}X^2 - (\mathbb{E}X)^2
\]</span>
Properties of the variance are homework questions.</p>
<p>In general,
<span class="math display">\[
\mathbb{E}X^k
\]</span>
is call the <span class="math inline">\(k\)</span>th moment of <span class="math inline">\(X\)</span>.</p>
</div>
<div id="section-properties-of-expectations" class="section level4 hasAnchor" number="2.2.3.3">
<h4><span class="header-section-number">2.2.3.3</span> Properties of expectations<a href="section-probability.html#section-properties-of-expectations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(\mathbb{E}a X + b = a \mathbb{E}X + b\)</span></li>
<li><span class="math inline">\(\mathbb{E}\{ \mathbb{E}X\} = \mathbb{E}X\)</span> (<span class="math inline">\(\mathbb{E}X\)</span> is a constant)</li>
</ul>
</div>
<div id="section-expected-value-for-bernoulli" class="section level4 hasAnchor" number="2.2.3.4">
<h4><span class="header-section-number">2.2.3.4</span> Expected value for Bernoulli<a href="section-probability.html#section-expected-value-for-bernoulli" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>For the Bernoulli <span class="math inline">\(X\sim \text{Be}(p)\)</span> the expectation is
<span class="math display">\[
\mathbb{E}X = \sum_{i=0}^1 x_i f_X(x_i) = 1 \times p + 0 \times (1-p) = p
\]</span></li>
</ul>
</div>
<div id="section-expected-value-for-multinomial" class="section level4 hasAnchor" number="2.2.3.5">
<h4><span class="header-section-number">2.2.3.5</span> Expected value for Multinomial<a href="section-probability.html#section-expected-value-for-multinomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(Y\)</span></th>
<th align="center"><span class="math inline">\(P(Y)\)</span></th>
<th align="center"><span class="math inline">\(P(Y)\)</span></th>
<th align="center"><span class="math inline">\(P(Y)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="center">1/4</td>
<td align="center">.1</td>
<td align="center">.7</td>
</tr>
<tr class="even">
<td>2</td>
<td align="center">1/4</td>
<td align="center">.2</td>
<td align="center">.1</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="center">1/4</td>
<td align="center">.3</td>
<td align="center">.1</td>
</tr>
<tr class="even">
<td>4</td>
<td align="center">1/4</td>
<td align="center">.4</td>
<td align="center">.1</td>
</tr>
</tbody>
</table>
</div>
<div id="section-expected-value-for-wordle-score" class="section level4 hasAnchor" number="2.2.3.6">
<h4><span class="header-section-number">2.2.3.6</span> Expected value for Wordle score<a href="section-probability.html#section-expected-value-for-wordle-score" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(Y=\)</span>Number of tries</th>
<th align="center"><span class="math inline">\(P(Y)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="center">0.28</td>
</tr>
<tr class="even">
<td>4</td>
<td align="center">0.40</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="center">0.18</td>
</tr>
<tr class="even">
<td>6</td>
<td align="center">0.11</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb6-1"><a href="section-probability.html#section-cb6-1" tabindex="-1"></a>wordle <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">7</span>)</span>
<span id="section-cb6-2"><a href="section-probability.html#section-cb6-2" tabindex="-1"></a><span class="co">#wordle/sum(wordle)</span></span>
<span id="section-cb6-3"><a href="section-probability.html#section-cb6-3" tabindex="-1"></a><span class="co">#round(wordle/sum(wordle), 2)</span></span></code></pre></div>
</details>
<center>
<div class="float" id="section-id">
<img src="figures/wordle.jpg" class="class" style="width:25.0%" alt="Wordle results" />
<div class="figcaption">Wordle results</div>
</div>
</center>
</div>
</div>
</div>
<div id="section-expectations-etc." class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Expectations etc.<a href="section-probability.html#section-expectations-etc." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>We’re reviewing probability that we need to study the concepts in the course.</li>
<li>We’ll do a bit more on expectations and then move on to joint random variables.</li>
<li>Next week we’ll start connecting probability to datasets.</li>
</ul>
<div id="section-more-on-expectations" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> More on expectations<a href="section-probability.html#section-more-on-expectations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="section-expected-value-for-bernoulli-1" class="section level4 hasAnchor" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> Expected value for Bernoulli<a href="section-probability.html#section-expected-value-for-bernoulli-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>For the Bernoulli <span class="math inline">\(X\sim \text{Be}(p)\)</span> the expectation is
<span class="math display">\[
\mathbb{E}X = \sum_{i=0}^1 x_i f_X(x_i) = 1 \times p + 0 \times (1-p) = p
\]</span></p></li>
<li><p>What is the variance of Bernoulli?</p></li>
</ul>
</div>
<div id="section-expected-value-for-poisson-random-variable" class="section level4 hasAnchor" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> Expected value for Poisson random variable<a href="section-probability.html#section-expected-value-for-poisson-random-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Poisson random variables are useful for modeling skewed counts.</li>
<li>E.g. number of drinks of alcohol in a week.</li>
<li>E.g. score on a depression inventory or other psychology/scale.</li>
</ul>
<p><span class="math display">\[
f(x; \lambda)  =  \frac{\lambda^x\ e^{-\lambda}}{x!}
\]</span></p>
<ul>
<li>Expectation and Variance of Poisson distribution</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb7-1"><a href="section-probability.html#section-cb7-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="section-cb7-2"><a href="section-probability.html#section-cb7-2" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">dpois</span>(x, <span class="at">lambda=</span><span class="dv">5</span>), <span class="at">main=</span><span class="st">&#39;Poisson(5)/Poisson(0.5)&#39;</span>, <span class="at">type=</span><span class="st">&#39;p&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;P(X=x)&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="section-cb7-3"><a href="section-probability.html#section-cb7-3" tabindex="-1"></a><span class="fu">points</span>(x, <span class="fu">dpois</span>(x, <span class="at">lambda=</span><span class="fl">0.5</span>), <span class="at">type=</span><span class="st">&#39;p&#39;</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="480" /></p>
</div>
<div id="section-expected-value-for-standard-normal-distribution" class="section level4 hasAnchor" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> Expected value for standard Normal distribution<a href="section-probability.html#section-expected-value-for-standard-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Start with the standardized normal distribution
<span class="math display">\[\begin{align*}
\mathbb{E}X &amp; = \int_{-\infty}^\infty x \left(2\pi \right)^{-1/2} \exp\left\{-\frac{1}{2} x^2 \right\}\\
&amp; = \left(2\pi \right)^{-1/2} \int_{0}^\infty \exp\{-u\} du - \left(2\pi \right)^{-1/2} \int_{0}^\infty \exp\{-u\} du
\end{align*}\]</span>
where <span class="math inline">\(u = x^2/2\)</span>.</p>
<ul>
<li>This equals zero.</li>
</ul>
</div>
<div id="section-expected-value-for-normal-distribution" class="section level4 hasAnchor" number="2.3.1.4">
<h4><span class="header-section-number">2.3.1.4</span> Expected value for Normal distribution<a href="section-probability.html#section-expected-value-for-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Start with the standardized normal distribution and use change of variables.</p>
<ul>
<li>For <span class="math inline">\(X\sim N(0,1)\)</span>, let <span class="math inline">\(Y = X\sigma + \mu\)</span>.</li>
<li>What is <span class="math inline">\(\mathbb{E}Y\)</span>?</li>
<li>Then <span class="math inline">\(\mathbb{P}(Y&lt;z) = \mathbb{P}((X\sigma+\mu)&lt;z) = \mathbb{P}(X&lt; (z - \mu)/\sigma) = \int_{-\infty}^{(z-\mu)/\sigma} \left(2\pi \right)^{-1/2} \exp\left\{-\frac{1}{2} x^2 \right\} dx= \int_{-\infty}^{y} \left(2\pi \sigma^2\right)^{-1/2} \exp\left\{-\frac{1}{2\sigma^2} (w-\mu)^2 \right\} dw\)</span></li>
<li>This is the CDF a <span class="math inline">\(N(\mu, \sigma^2)\)</span>.</li>
</ul>
</div>
<div id="section-properties-of-variance" class="section level4 hasAnchor" number="2.3.1.5">
<h4><span class="header-section-number">2.3.1.5</span> Properties of variance<a href="section-probability.html#section-properties-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(\mathrm{Var}(aX +b) = a^2 \mathrm{Var}(X)\)</span></li>
</ul>
</div>
</div>
</div>
<div id="section-multivariate-random-variables" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Multivariate random variables<a href="section-probability.html#section-multivariate-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-overview-2" class="section level4 hasAnchor" number="2.4.0.1">
<h4><span class="header-section-number">2.4.0.1</span> Overview<a href="section-probability.html#section-overview-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(W = (X, Y) \in \mathcal{B}\)</span> be a multivariate random variable.
<span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be continuous or discrete.
For example <span class="math inline">\(X,Y\)</span> can be multivariate normal.</p>
</div>
<div id="section-example" class="section level4 hasAnchor" number="2.4.0.2">
<h4><span class="header-section-number">2.4.0.2</span> Example<a href="section-probability.html#section-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For <span class="math inline">\(X\in\{1,2\}\)</span> and <span class="math inline">\(Y \in \{1,2,3\}\)</span></p>
<ul>
<li>Joint probability table</li>
<li>Marginal probabilities</li>
<li>Conditional probabilities (intuitively)</li>
</ul>
<p>Draw the 3 different tables.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb8-1"><a href="section-probability.html#section-cb8-1" tabindex="-1"></a>probs <span class="ot">=</span> <span class="fu">data.frame</span>( <span class="at">X=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">2</span>), <span class="at">Y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dv">3</span>))</span>
<span id="section-cb8-2"><a href="section-probability.html#section-cb8-2" tabindex="-1"></a>probs<span class="sc">$</span>p <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;$p_{&#39;</span>, probs<span class="sc">$</span>X, probs<span class="sc">$</span>Y, <span class="st">&#39;}$&#39;</span>)</span>
<span id="section-cb8-3"><a href="section-probability.html#section-cb8-3" tabindex="-1"></a>tabout <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">table</span>(probs<span class="sc">$</span>X, probs<span class="sc">$</span>Y))</span>
<span id="section-cb8-4"><a href="section-probability.html#section-cb8-4" tabindex="-1"></a>tabout[,] <span class="ot">=</span> probs<span class="sc">$</span>p</span>
<span id="section-cb8-5"><a href="section-probability.html#section-cb8-5" tabindex="-1"></a>tabout <span class="ot">=</span> <span class="fu">t</span>(tabout)</span>
<span id="section-cb8-6"><a href="section-probability.html#section-cb8-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tabout, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">escape =</span> <span class="cn">FALSE</span> )</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left"><span class="math inline">\(p_{11}\)</span></td>
<td align="left"><span class="math inline">\(p_{12}\)</span></td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left"><span class="math inline">\(p_{21}\)</span></td>
<td align="left"><span class="math inline">\(p_{22}\)</span></td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left"><span class="math inline">\(p_{31}\)</span></td>
<td align="left"><span class="math inline">\(p_{32}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="section-example-umbrella-and-raining" class="section level4 hasAnchor" number="2.4.0.3">
<h4><span class="header-section-number">2.4.0.3</span> Example: Umbrella and raining<a href="section-probability.html#section-example-umbrella-and-raining" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>A common example is whether someone brings an umbrella with them</li>
</ul>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">It’s not raining</th>
<th align="center">It’s raining</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>I don’t bring umbrella</td>
<td align="center">0.05</td>
<td align="center">0.17</td>
</tr>
<tr class="even">
<td>I bring umbrella</td>
<td align="center">0.35</td>
<td align="center">0.43</td>
</tr>
</tbody>
</table>
<p>Another example</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">It’s not precipitating</th>
<th align="center">It’s raining</th>
<th align="center">It’s snowing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>I don’t bring umbrella</td>
<td align="center">0.05</td>
<td align="center">0.17</td>
<td align="center">0.02</td>
</tr>
<tr class="even">
<td>I bring umbrella</td>
<td align="center">0.35</td>
<td align="center">0.40</td>
<td align="center">0.03</td>
</tr>
</tbody>
</table>
</div>
<div id="section-distribution-functions" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Distribution functions<a href="section-probability.html#section-distribution-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution function for multivariate random variables is often written in terms of subsets <span class="math inline">\(B \subset \mathcal{B}\)</span>
<span class="math display">\[
F_W(B) = \mathbb{P}(W \in B).
\]</span></p>
<p>If <span class="math inline">\(W\)</span> has a density then we can also write for values <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> (in the appropriate domain)
<span class="math display">\[
\mathbb{P}(W \in B) = \int_{\mathcal{B}} f_W(x, y)dx dy,
\]</span>
where <span class="math inline">\(f_W\)</span> is the PDF or PMF of <span class="math inline">\(W = (X,Y)\)</span>.</p>
</div>
<div id="section-marginal-probability" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Marginal probability<a href="section-probability.html#section-marginal-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The marginal probability, <span class="math inline">\(\mathbb{P}(Y=y)\)</span> is the probability for <span class="math inline">\(Y\)</span> ignoring whatever is going on with <span class="math inline">\(X\)</span>.</li>
<li>This can be found by integrating out the <span class="math inline">\(X\)</span> variable.
<span class="math display">\[
f_Y(y) = \int_\mathcal{X} f_{X,Y}(x, y)dx
\]</span></li>
<li>Joint multinomial above to demonstrate this.</li>
</ul>
</div>
<div id="section-conditional-distribution" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Conditional distribution<a href="section-probability.html#section-conditional-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
Conditional distributions can be written in terms of the underlying probability space. For sets <span class="math inline">\(A, B \subset \mathcal{B}\)</span>
<span class="math display">\[
\mathbb{P}(A \mid B ) = \frac{\mathbb{P}( A \cap B)}{\mathbb{P}(B)}
\]</span>
<center>
<div class="float" id="section-id">
<img src="figures/venn.png" class="class" style="width:25.0%;height:25.0%" alt="Venn diagram of sets" />
<div class="figcaption">Venn diagram of sets</div>
</div>
</center>
<p>Conceptually, the denominator adjusts the numerator for the fact that we are only considering events that include B occurring. This makes the conditional probabilities sum to 1.</p>
<p>For multivariate random variables the definition is similar
<span class="math display">\[
\mathbb{P}(Y=y \mid X=x) = \frac{\mathbb{P}(X=x, Y=y)}{\mathbb{P}(X=x)}
\]</span></p>
<ul>
<li>Can think of the Venn diagram in terms of the joint random variable falling into the set.</li>
<li>Probability I bring and umbrella given that it’s raining</li>
<li>Probability it’s raining given it’s not precipitating (Conditioning on itself)</li>
</ul>
</div>
<div id="section-examples" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Examples<a href="section-probability.html#section-examples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="section-insurance-dataset-children-and-region" class="section level4 hasAnchor" number="2.4.4.1">
<h4><span class="header-section-number">2.4.4.1</span> Insurance dataset children and region<a href="section-probability.html#section-insurance-dataset-children-and-region" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>In the insurance dataset, we can consider the probability of having a certain number of children living in a certain area.</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb9-1"><a href="section-probability.html#section-cb9-1" tabindex="-1"></a><span class="fu">library</span>(RESI) <span class="co"># contains insurance dataset</span></span>
<span id="section-cb9-2"><a href="section-probability.html#section-cb9-2" tabindex="-1"></a>childByRegion <span class="ot">=</span> <span class="fu">table</span>(insurance<span class="sc">$</span>region, insurance<span class="sc">$</span>children)</span>
<span id="section-cb9-3"><a href="section-probability.html#section-cb9-3" tabindex="-1"></a>childByRegion <span class="ot">=</span> childByRegion<span class="sc">/</span><span class="fu">sum</span>(childByRegion)</span>
<span id="section-cb9-4"><a href="section-probability.html#section-cb9-4" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(childByRegion, <span class="dv">2</span>))</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">northeast</td>
<td align="right">0.11</td>
<td align="right">0.06</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">northwest</td>
<td align="right">0.10</td>
<td align="right">0.06</td>
<td align="right">0.05</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">southeast</td>
<td align="right">0.12</td>
<td align="right">0.07</td>
<td align="right">0.05</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">southwest</td>
<td align="right">0.10</td>
<td align="right">0.06</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
<td align="right">0.01</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Let <span class="math inline">\(X\)</span> be a random variable denoting number of children</p>
<ul>
<li>Is it categorical/continuous/ordinal?</li>
</ul></li>
<li><p>Let <span class="math inline">\(Y\)</span> be a random variable denoting region</p>
<ul>
<li>Is it categorical/continuous/ordinal?</li>
</ul></li>
<li><p>joint distribution is a function of both variables <span class="math inline">\(\mathbb{P}(X=x, Y=y) = f(x,y)\)</span>.</p></li>
<li><p>Questions about regional differences and number of children can be determined from the table</p></li>
<li><p>What is the probability of having zero kids and living in the east?</p></li>
<li><p>What is the probability of having zero kids?</p></li>
</ul>
</div>
<div id="section-insurance-data-multivariate-distribution-of-age-and-charges" class="section level4 hasAnchor" number="2.4.4.2">
<h4><span class="header-section-number">2.4.4.2</span> Insurance data multivariate distribution of age and charges<a href="section-probability.html#section-insurance-data-multivariate-distribution-of-age-and-charges" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb10-1"><a href="section-probability.html#section-cb10-1" tabindex="-1"></a><span class="fu">library</span>(RESI)</span>
<span id="section-cb10-2"><a href="section-probability.html#section-cb10-2" tabindex="-1"></a>name<span class="ot">=</span><span class="st">&#39;charges&#39;</span></span>
<span id="section-cb10-3"><a href="section-probability.html#section-cb10-3" tabindex="-1"></a><span class="fu">hist</span>(insurance[,name], <span class="at">xlab=</span>name, <span class="at">main=</span>name, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="section-cb10-4"><a href="section-probability.html#section-cb10-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(insurance[,name], <span class="at">adjust=</span><span class="fl">1.5</span>), <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="240" /></p>
<ul>
<li>Relationship between age and charges in the insurance data</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb11-1"><a href="section-probability.html#section-cb11-1" tabindex="-1"></a><span class="fu">plot</span>(insurance[,<span class="st">&#39;age&#39;</span>], insurance<span class="sc">$</span>charges, <span class="at">ylab=</span><span class="st">&#39;Charges&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Age&#39;</span>, <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;and&#39;</span>, <span class="st">&#39;Charges&#39;</span>) )</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="240" /></p>
<ul>
<li>The scatter plot can be thought of as a dataset version of a joint density <span class="math inline">\(f_{X,Y}(x,y)\)</span></li>
<li>We can get the conditional histograms for a few different age groups</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb12-1"><a href="section-probability.html#section-cb12-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="fl">2.8</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">6</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</span>
<span id="section-cb12-2"><a href="section-probability.html#section-cb12-2" tabindex="-1"></a>nbin <span class="ot">=</span> <span class="dv">15</span></span>
<span id="section-cb12-3"><a href="section-probability.html#section-cb12-3" tabindex="-1"></a>insCat <span class="ot">=</span> <span class="fu">with</span>(insurance, <span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(age), <span class="fu">max</span>(age), <span class="at">length.out=</span><span class="dv">7</span>), <span class="at">include.lowest=</span>T), <span class="at">charges=</span><span class="fu">cut</span>(charges<span class="sc">/</span><span class="dv">1000</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(charges<span class="sc">/</span><span class="dv">1000</span>), <span class="fu">max</span>(charges<span class="sc">/</span><span class="dv">1000</span>), <span class="at">length.out=</span>nbin), <span class="at">include.lowest=</span>T) ) )</span>
<span id="section-cb12-4"><a href="section-probability.html#section-cb12-4" tabindex="-1"></a>condTab <span class="ot">=</span> <span class="fu">do.call</span>(cbind, <span class="fu">by</span>(insCat<span class="sc">$</span>charges, insCat<span class="sc">$</span>age, <span class="cf">function</span>(x){res<span class="ot">=</span><span class="fu">table</span>(x); res<span class="sc">/</span><span class="fu">sum</span>(res)}))</span>
<span id="section-cb12-5"><a href="section-probability.html#section-cb12-5" tabindex="-1"></a><span class="fu">barplot</span>(condTab, <span class="at">beside=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rep</span>(cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(condTab)], <span class="at">each=</span>nbin<span class="dv">-1</span>),</span>
<span id="section-cb12-6"><a href="section-probability.html#section-cb12-6" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(condTab), <span class="fu">ncol</span>(condTab) ), <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&#39;Charges (in thousands)&#39;</span>, <span class="at">main=</span><span class="st">&#39;Conditional frequencies&#39;</span>)</span>
<span id="section-cb12-7"><a href="section-probability.html#section-cb12-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">fill=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(condTab)], <span class="at">legend=</span><span class="fu">colnames</span>(condTab), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="1440" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb13-1"><a href="section-probability.html#section-cb13-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="fl">2.8</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">6</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</span>
<span id="section-cb13-2"><a href="section-probability.html#section-cb13-2" tabindex="-1"></a>nbin <span class="ot">=</span> <span class="dv">15</span></span>
<span id="section-cb13-3"><a href="section-probability.html#section-cb13-3" tabindex="-1"></a>jointTab <span class="ot">=</span> <span class="fu">do.call</span>(cbind, <span class="fu">by</span>(insCat<span class="sc">$</span>charges, insCat<span class="sc">$</span>age, <span class="cf">function</span>(x){res<span class="ot">=</span><span class="fu">table</span>(x); res}))</span>
<span id="section-cb13-4"><a href="section-probability.html#section-cb13-4" tabindex="-1"></a>jointTab <span class="ot">=</span> jointTab<span class="sc">/</span><span class="fu">sum</span>(jointTab)</span>
<span id="section-cb13-5"><a href="section-probability.html#section-cb13-5" tabindex="-1"></a><span class="fu">barplot</span>(jointTab, <span class="at">beside=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">rep</span>(cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(jointTab)], <span class="at">each=</span>nbin<span class="dv">-1</span>),</span>
<span id="section-cb13-6"><a href="section-probability.html#section-cb13-6" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(jointTab), <span class="fu">ncol</span>(jointTab) ), <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&#39;Charges (in thousands)&#39;</span>, <span class="at">main=</span><span class="st">&#39;Joint frequencies&#39;</span>)</span>
<span id="section-cb13-7"><a href="section-probability.html#section-cb13-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">fill=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(jointTab)], <span class="at">legend=</span><span class="fu">colnames</span>(jointTab), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="1440" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb14-1"><a href="section-probability.html#section-cb14-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="fl">2.8</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">6</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</span>
<span id="section-cb14-2"><a href="section-probability.html#section-cb14-2" tabindex="-1"></a>nbin <span class="ot">=</span> <span class="dv">15</span></span>
<span id="section-cb14-3"><a href="section-probability.html#section-cb14-3" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">barplot</span>(<span class="fu">t</span>(jointTab), <span class="at">beside=</span><span class="cn">FALSE</span>, <span class="at">col=</span>cols[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(jointTab), nbin<span class="dv">-1</span>)], <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&#39;Charges (in thousands)&#39;</span>, <span class="at">main=</span><span class="st">&#39;Marginal frequencies&#39;</span>, <span class="at">space=</span><span class="dv">0</span>)</span>
<span id="section-cb14-4"><a href="section-probability.html#section-cb14-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">fill=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(jointTab)], <span class="at">legend=</span><span class="fu">colnames</span>(jointTab), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="1440" /></p>
</div>
</div>
<div id="section-conditional-means-and-variances" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Conditional means and variances<a href="section-probability.html#section-conditional-means-and-variances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Once you have conditional probabilities, you can do all the same stuff with it that you would do with a regular random variable</li>
<li>For example, <span class="math inline">\(\mathbb{E}(X \mid Y) = \sum_{x} x f_{X\mid Y}(x \mid y)\)</span></li>
</ul>
<p>Conditional expectation is just an expectation with respect to a conditional distribution.
<span class="math display">\[
\begin{align*}
\mathbb{E}(Y \mid X=x) &amp; = \int_{\mathcal{Y}} yf_{Y\mid X=x}(y\mid x)dy \\
&amp; = \int_{\mathcal{Y}} yf_{Y,X}(y, x)/f(x)dy \\
&amp; = \int_{\mathcal{Y}} yf_{Y,X}(y, X)/f(X)dy
\end{align*}
\]</span></p>
<p>It can still be thought of as random with respect to the conditioning variable.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center"><span class="math inline">\(P(X=1)=.1\)</span></th>
<th align="center"><span class="math inline">\(P(X=2) = .7\)</span></th>
<th align="center"><span class="math inline">\(P(X=3)=.2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y\)</span></td>
<td align="center"><span class="math inline">\(P(Y|X=1)\)</span></td>
<td align="center"><span class="math inline">\(P(Y| X=2)\)</span></td>
<td align="center"><span class="math inline">\(P(Y| X=3)\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td align="center">1/4</td>
<td align="center">.1</td>
<td align="center">.7</td>
</tr>
<tr class="odd">
<td>2</td>
<td align="center">1/4</td>
<td align="center">.2</td>
<td align="center">.1</td>
</tr>
<tr class="even">
<td>3</td>
<td align="center">1/4</td>
<td align="center">.3</td>
<td align="center">.1</td>
</tr>
<tr class="odd">
<td>4</td>
<td align="center">1/4</td>
<td align="center">.4</td>
<td align="center">.1</td>
</tr>
</tbody>
</table>
</div>
<div id="section-properties-of-expectation-for-two-random-variables" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Properties of expectation for two random variables<a href="section-probability.html#section-properties-of-expectation-for-two-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Expectation is linear because it is an integral. For example, for constants <span class="math inline">\(a,b\)</span> and random variables <span class="math inline">\(X,Y\)</span>
<span class="math display">\[
\mathbb{E}(aX + bY) = a \mathbb{E} X + b\mathbb{E}Y
\]</span>
I’ll often write it without parentheses (e.g. <span class="math inline">\(\mathbb{E}aX\)</span>).</p>
<div id="section-example-discrete-and-continuous-joint-distribution" class="section level4 hasAnchor" number="2.4.6.1">
<h4><span class="header-section-number">2.4.6.1</span> Example: discrete and continuous joint distribution<a href="section-probability.html#section-example-discrete-and-continuous-joint-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Diagnosis and hippocampus volume in Alzheimer’s disease.</li>
<li><span class="math inline">\(P(DX)\)</span> is multinomial, <span class="math inline">\(P(Hipp\mid DX)\)</span> assumed to be normal.</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb15-1"><a href="section-probability.html#section-cb15-1" tabindex="-1"></a>adni <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&#39;../datasets/adni/hippocampus.rds&#39;</span>)</span>
<span id="section-cb15-2"><a href="section-probability.html#section-cb15-2" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">do.call</span>(rbind, <span class="fu">by</span>(adni<span class="sc">$</span>LEFTHIPPO, adni<span class="sc">$</span>DX, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">var</span>(x)) )), <span class="dv">0</span>)</span>
<span id="section-cb15-3"><a href="section-probability.html#section-cb15-3" tabindex="-1"></a>pX <span class="ot">=</span> <span class="fu">table</span>(adni<span class="sc">$</span>DX); pX <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(pX<span class="sc">/</span><span class="fu">sum</span>(pX),<span class="dv">2</span>)); <span class="fu">names</span>(pX) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;P(X)&#39;</span>)</span>
<span id="section-cb15-4"><a href="section-probability.html#section-cb15-4" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>)</span>
<span id="section-cb15-5"><a href="section-probability.html#section-cb15-5" tabindex="-1"></a></span>
<span id="section-cb15-6"><a href="section-probability.html#section-cb15-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pX, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">escape =</span> <span class="cn">FALSE</span> )</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="left">X</th>
<th align="right">P(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AD</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="left">HC</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="left">MCI</td>
<td align="right">0.45</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb16-1"><a href="section-probability.html#section-cb16-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">escape =</span> <span class="cn">FALSE</span> )</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AD</td>
<td align="right">1549</td>
<td align="right">109794</td>
</tr>
<tr class="even">
<td align="left">HC</td>
<td align="right">2122</td>
<td align="right">89241</td>
</tr>
<tr class="odd">
<td align="left">MCI</td>
<td align="right">1803</td>
<td align="right">131030</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-independence" class="section level3 hasAnchor" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Independence<a href="section-probability.html#section-independence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Two random variables are independent if they factor <span class="math inline">\(\mathbb{P}(X=x, Y=y) = \mathbb{P}(X=x)\mathbb{P}(Y=y)\)</span> for all possible values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
<li>Intuitively, this means that fixing one variable doesn’t affect the distribution of the other.</li>
<li>Another way to express it is that <span class="math inline">\(\mathbb{P}(X=x\mid Y=y) = \mathbb{P}(X=x)\)</span>.</li>
<li>The table is pretty close to independent.</li>
</ul>
<p>If the table above were perfectly independent, it might look like this:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb17-1"><a href="section-probability.html#section-cb17-1" tabindex="-1"></a>rs <span class="ot">=</span> <span class="fu">rowSums</span>(childByRegion)</span>
<span id="section-cb17-2"><a href="section-probability.html#section-cb17-2" tabindex="-1"></a>cs <span class="ot">=</span> <span class="fu">colSums</span>(childByRegion)</span>
<span id="section-cb17-3"><a href="section-probability.html#section-cb17-3" tabindex="-1"></a>indepTab <span class="ot">=</span> <span class="fu">outer</span>(rs, cs)</span>
<span id="section-cb17-4"><a href="section-probability.html#section-cb17-4" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(indepTab, <span class="dv">3</span>))</span></code></pre></div>
</details>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">northeast</td>
<td align="right">0.104</td>
<td align="right">0.059</td>
<td align="right">0.043</td>
<td align="right">0.028</td>
<td align="right">0.005</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">northwest</td>
<td align="right">0.104</td>
<td align="right">0.059</td>
<td align="right">0.044</td>
<td align="right">0.029</td>
<td align="right">0.005</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">southeast</td>
<td align="right">0.117</td>
<td align="right">0.066</td>
<td align="right">0.049</td>
<td align="right">0.032</td>
<td align="right">0.005</td>
<td align="right">0.004</td>
</tr>
<tr class="even">
<td align="left">southwest</td>
<td align="right">0.104</td>
<td align="right">0.059</td>
<td align="right">0.044</td>
<td align="right">0.029</td>
<td align="right">0.005</td>
<td align="right">0.003</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb18-1"><a href="section-probability.html#section-cb18-1" tabindex="-1"></a><span class="fu">barplot</span>(indepTab, <span class="at">main=</span><span class="st">&#39;Joint probabilities&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Probability&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Number of children&#39;</span>, <span class="at">beside=</span>T, <span class="at">col=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(indepTab)])</span>
<span id="section-cb18-2"><a href="section-probability.html#section-cb18-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">fill=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(indepTab)], <span class="at">legend=</span><span class="fu">rownames</span>(indepTab), <span class="at">bty=</span><span class="st">&#39;n&#39;</span> )</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" width="576" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb19-1"><a href="section-probability.html#section-cb19-1" tabindex="-1"></a>condTab <span class="ot">=</span> <span class="fu">sweep</span>(indepTab, <span class="dv">1</span>, <span class="fu">rowSums</span>(childByRegion), <span class="at">FUN =</span> <span class="st">&#39;/&#39;</span>)</span>
<span id="section-cb19-2"><a href="section-probability.html#section-cb19-2" tabindex="-1"></a><span class="fu">barplot</span>(condTab, <span class="at">main=</span><span class="st">&#39;Conditional probabilities&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Probability&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Number of children&#39;</span>, <span class="at">beside=</span>T, <span class="at">col=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(condTab)])</span>
<span id="section-cb19-3"><a href="section-probability.html#section-cb19-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">fill=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(condTab)], <span class="at">legend=</span><span class="fu">rownames</span>(condTab), <span class="at">bty=</span><span class="st">&#39;n&#39;</span> )</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-17-2.png" width="576" /></p>
<ul>
<li>This means that <strong>they are independent if their CDFs or PDFs factor</strong>!</li>
<li>Intuitively, two random variables are independent if the value of one does not affect the probability distribution of the other.</li>
<li>Mathematically, that implies <span class="math inline">\(\mathbb{P}(X=x \mid Y=y) = \mathbb{P}(X=x)\)</span> (this is a homework question).</li>
</ul>
</div>
<div id="section-covariance-and-dependence" class="section level3 hasAnchor" number="2.4.8">
<h3><span class="header-section-number">2.4.8</span> Covariance and dependence<a href="section-probability.html#section-covariance-and-dependence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Expand this and derive the other formula
<span class="math display">\[
\text{Cov}(X, Y) = \mathbb{E}(X-\mathbb{E}X)(Y-\mathbb{E}Y)
\]</span></p>
<p>Correlation is
<span class="math display">\[
\begin{align*}
\text{Cor}(X,Y) = \frac{\text{Cov}(X,Y)}{\sqrt{\text{Var}(X)\text{Var}(Y)}}
\end{align*}
\]</span></p>
<ul>
<li>Covariance implies dependence, but dependence does not imply covariance (homework question)</li>
<li>Independence implies zero covariance, but dependence does not imply nonzero covariance</li>
</ul>
</div>
<div id="section-properties-of-variances-of-sums" class="section level3 hasAnchor" number="2.4.9">
<h3><span class="header-section-number">2.4.9</span> Properties of variances of sums<a href="section-probability.html#section-properties-of-variances-of-sums" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Derive the variance of this</p>
<ul>
<li><span class="math inline">\(\text{Var}(X + Y) = \mathrm{Var}(X) + \mathrm{Var}(Y) + 2\text{Cov}(X, Y)\)</span></li>
</ul>
</div>
<div id="section-law-of-total-expectation" class="section level3 hasAnchor" number="2.4.10">
<h3><span class="header-section-number">2.4.10</span> Law of total expectation<a href="section-probability.html#section-law-of-total-expectation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The law of total expectation is relatively simple, but super handy.
<span class="math display">\[
\mathbb{E}\{\mathbb{E}(X \mid Y)\} = \mathbb{E}X
\]</span>
If you are trying to take a mean of a complicated random variable, then you can condition on part of it first and then take the expectation of the part you conditioned on.</p>
<ul>
<li><p>Example: continue from last table</p></li>
<li><p>Example: Use diagnosis and hippocampal volume above</p></li>
<li><p>Example from Rice:</p></li>
</ul>
<p><img src="figures/rice_total_expectation.png" id="section-id" class="class" style="width:100.0%;height:60.0%" /></p>
</div>
<div id="section-law-of-total-variance" class="section level3 hasAnchor" number="2.4.11">
<h3><span class="header-section-number">2.4.11</span> Law of total variance<a href="section-probability.html#section-law-of-total-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The law of total variance states that
<span class="math display">\[
\text{Var}(Y) = \mathbb{E}\text{Var}(Y \mid X) + \text{Var}\{ \mathbb{E}(Y \mid X)\}.
\]</span></p>
<ul>
<li>Example: continue from last table</li>
<li>Example: Use diagnosis and hippocampal volume above</li>
</ul>
<p><img src="figures/rice_total_variance.png" id="section-id" class="class" style="width:100.0%;height:60.0%" /></p>
</div>
</div>
<div id="section-parameters-estimates-and-estimators" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Parameters, estimates, and estimators<a href="section-probability.html#section-parameters-estimates-and-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-objectives-2" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Objectives<a href="section-probability.html#section-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Today we will</p>
<ul>
<li>Talk about parameters, estimates, and estimators</li>
<li>Talk about how to assess estimators by comparing their variance and bias</li>
</ul>
</div>
<div id="section-statistics-is-a-way-to-learn-about-the-world-from-a-data-set" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Statistics is a way to learn about the world from a data set<a href="section-probability.html#section-statistics-is-a-way-to-learn-about-the-world-from-a-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All three statistical philosophies we will discuss view research questions as trying to learn about an unknown parameter.</p>
<p>For now, let’s work with the question, “What is the proportion of people in the united states who have used alcohol in the last 30 days?”</p>
<ol style="list-style-type: decimal">
<li>What is my parameter of interest (target parameter)?
<ul>
<li>Descriptively – proportion of people who have used alcohol</li>
<li>Mathematically – call this value <span class="math inline">\(p\)</span></li>
</ul></li>
<li>What is my population of interest?
<ul>
<li>Descriptively – The United States population</li>
<li>Quantitatively two possible things
<ul>
<li>Distribution defined by the model below in point 4. <span class="math inline">\(\text{Be}(p)\)</span></li>
<li>Unknown statistical distribution that gives rise to how someone in the US answers the question, “have you consumed alcohol in the last 30 days?”.</li>
</ul></li>
</ul></li>
<li>What is a data point?
<ul>
<li>An answer from an individual in the population “yes”/“no” to the survey question. Coded as 1/0.</li>
</ul></li>
<li>What model can I use to describe how I get a data point?
<ul>
<li>Most obvious one is <span class="math inline">\(X_i \sim \text{Be}(p)\)</span>, where <span class="math inline">\(p\)</span> is the parameter in point 1.</li>
</ul></li>
</ol>
</div>
<div id="section-a-random-sample-for-the-alcohol-question" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> A random sample for the alcohol question<a href="section-probability.html#section-a-random-sample-for-the-alcohol-question" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A random sample is a collection of independent random variables that represent potential data points.</p>
<p>Let <span class="math inline">\(X_i \sim \text{Be}(p)\)</span> for <span class="math inline">\(i=1,\ldots, n\)</span>.</p>
<p>Our assumption about the population <span class="math inline">\(X_i\)</span> is drawn from connects the data to the parameter of interest.</p>
<p>Given our data, we have a parameter and estimate of the parameter. What are they?</p>
</div>
<div id="section-estimates" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Estimates<a href="section-probability.html#section-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note, an <strong>estimate</strong> is a function of the observed sample and it is nonrandom (Why is it non random?). We often use lowercase letters to make that clear
<span class="math display">\[
\bar x = n^{-1} \sum_{i=1}^n x_i.
\]</span></p>
</div>
<div id="section-estimators" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Estimators<a href="section-probability.html#section-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An <strong>estimator</strong> is a function of a random sample.
The goal (usually) is to estimate a parameter of interest (here, <span class="math inline">\(p\)</span>).
Let’s consider the estimator
<span class="math display">\[
\hat p = \bar X = n^{-1} \sum_{i=1}^n X_i,
\]</span>
which we know is pretty reasonable since <span class="math inline">\(\mathbb{E}\bar X = p\)</span>.</p>
<ul>
<li>We can study the properties of estimators to learn about how they behave.</li>
<li>If we like an estimator we can compute an estimate using our sample.</li>
<li>We can use features of our estimator to make probabilistic statements about what might happen if we repeat our study. <strong>Dataset-to-dataset variability</strong></li>
</ul>
</div>
<div id="section-properties-of-estimators" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Properties of estimators<a href="section-probability.html#section-properties-of-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some common metrics are</p>
<ul>
<li><p><strong>Bias:</strong> let <span class="math inline">\(p\)</span> denote our target parameter, bias is defined as
<span class="math display">\[
\mathbb{E}(\hat p - p).
\]</span></p></li>
<li><p><strong>Variance:</strong> this is the same as for other random variables
<span class="math display">\[
\mathbb{E}(\hat p - \mathbb{E}\hat p)^2
\]</span></p></li>
<li><p><strong>Mean Squared Error:</strong> this combines variance and bias:
<span class="math display">\[
\mathbb{E}(\hat p - p)^2
\]</span></p></li>
</ul>
</div>
<div id="section-bias-variance-and-mse-of-the-proportion-estimator" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> Bias, variance, and MSE of the proportion estimator<a href="section-probability.html#section-bias-variance-and-mse-of-the-proportion-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The bias of the proportion estimator (used to estimate the proportion of people who regularly drink alcohol) is:
<span class="math display">\[
\mathbb{E}( \hat p - p) = 0
\]</span></li>
<li>The variance of the estimator is
<span class="math display">\[
\begin{align*}
\text{Var}(\hat p)
&amp; = n^{-2} \sum_{i=1}^n\text{Var}(X_i) \\
&amp; = n^{-1} p(1-p)
\end{align*}
\]</span></li>
<li>The MSE is the same as the variance since <span class="math inline">\(\hat p\)</span> is unbiased.</li>
</ul>
<p>We will come back to this example to construct confidence intervals in the next lecture.</p>
</div>
<div id="section-nsduh-example-of-bias-variance-and-mse" class="section level3 hasAnchor" number="2.5.8">
<h3><span class="header-section-number">2.5.8</span> NSDUH: example of bias, variance, and MSE<a href="section-probability.html#section-nsduh-example-of-bias-variance-and-mse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>In NSDUH data</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb20-1"><a href="section-probability.html#section-cb20-1" tabindex="-1"></a>puf <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&#39;../datasets/nsduh/puf.rds&#39;</span>)</span>
<span id="section-cb20-2"><a href="section-probability.html#section-cb20-2" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">mean</span>(puf<span class="sc">$</span>alcmon<span class="sc">==</span><span class="st">&#39;yes&#39;</span>)</span>
<span id="section-cb20-3"><a href="section-probability.html#section-cb20-3" tabindex="-1"></a></span>
<span id="section-cb20-4"><a href="section-probability.html#section-cb20-4" tabindex="-1"></a></span>
<span id="section-cb20-5"><a href="section-probability.html#section-cb20-5" tabindex="-1"></a></span>
<span id="section-cb20-6"><a href="section-probability.html#section-cb20-6" tabindex="-1"></a><span class="co"># Show what Bias and Variance mean in NSDUH data using simulations</span></span>
<span id="section-cb20-7"><a href="section-probability.html#section-cb20-7" tabindex="-1"></a>nstudies <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="section-cb20-8"><a href="section-probability.html#section-cb20-8" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="section-cb20-9"><a href="section-probability.html#section-cb20-9" tabindex="-1"></a>phats <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nstudies)</span>
<span id="section-cb20-10"><a href="section-probability.html#section-cb20-10" tabindex="-1"></a><span class="cf">for</span>(study <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nstudies){</span>
<span id="section-cb20-11"><a href="section-probability.html#section-cb20-11" tabindex="-1"></a>  <span class="co"># random sample</span></span>
<span id="section-cb20-12"><a href="section-probability.html#section-cb20-12" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">prob =</span> p, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="section-cb20-13"><a href="section-probability.html#section-cb20-13" tabindex="-1"></a>  <span class="co"># estimate phat</span></span>
<span id="section-cb20-14"><a href="section-probability.html#section-cb20-14" tabindex="-1"></a>  phats[study] <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="section-cb20-15"><a href="section-probability.html#section-cb20-15" tabindex="-1"></a>}</span>
<span id="section-cb20-16"><a href="section-probability.html#section-cb20-16" tabindex="-1"></a></span>
<span id="section-cb20-17"><a href="section-probability.html#section-cb20-17" tabindex="-1"></a><span class="co"># mean of phat across the simulations</span></span>
<span id="section-cb20-18"><a href="section-probability.html#section-cb20-18" tabindex="-1"></a><span class="fu">mean</span>(phats)</span></code></pre></div>
</details>
<pre><code>## [1] 0.4513532</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb22-1"><a href="section-probability.html#section-cb22-1" tabindex="-1"></a><span class="fu">hist</span>(phats)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" width="288" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb23-1"><a href="section-probability.html#section-cb23-1" tabindex="-1"></a><span class="co"># variance of phat across the simulations</span></span>
<span id="section-cb23-2"><a href="section-probability.html#section-cb23-2" tabindex="-1"></a><span class="fu">var</span>(phats) <span class="co"># for n=100 this was 0.002527289</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.0002484349</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb25-1"><a href="section-probability.html#section-cb25-1" tabindex="-1"></a><span class="co"># what the variance should be equal to</span></span>
<span id="section-cb25-2"><a href="section-probability.html#section-cb25-2" tabindex="-1"></a>p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n</span></code></pre></div>
</details>
<pre><code>## [1] 0.0002476392</code></pre>
</div>
<div id="section-parameters-estimators-estimates" class="section level3 hasAnchor" number="2.5.9">
<h3><span class="header-section-number">2.5.9</span> Parameters, Estimators, Estimates<a href="section-probability.html#section-parameters-estimators-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To reiterate:</p>
<ul>
<li><strong>Parameter</strong> – Target unknown feature of a population (nonrandom)</li>
<li><strong>Estimate</strong> – Value computed from observed data to approximate the parameter (nonrandom)</li>
<li><strong>Estimator</strong> – A function of a random sample to approximate the parameter</li>
</ul>
<p>In statistics, probability is used to define and describe the behavior of estimators.</p>
<!-- In the last class we -->
<!-- * Defined a parameter (example was "$p$", proportion of US population who has used alcohol in the last 30 days). -->
<!-- * Used the concept of a random sample to compute an estimator of the parameter -->
<!--     + We assessed our estimator with three metrics (Bias, Variance, and Mean Square Error) -->
<ul>
<li>Often, the distribution of an estimator is makes it too hard to find the bias, variance, and MSE of the estimator.</li>
<li>In this case, we use simulations to <em>estimate</em> the bias, variance, and MSE of an estimator.</li>
<li>Important concepts for this session:
<ul>
<li>Simulations can be used to estimate the bias and variance when it is too hard to find mathematically.</li>
<li>Sometimes, the parameter of interest is not distributional parameter.</li>
</ul></li>
</ul>
</div>
<div id="section-example-for-today-multiplexed-immunofluorescence-mif-microscopy" class="section level3 hasAnchor" number="2.5.10">
<h3><span class="header-section-number">2.5.10</span> Example for today: multiplexed immunofluorescence (mIF) microscopy<a href="section-probability.html#section-example-for-today-multiplexed-immunofluorescence-mif-microscopy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>mIF imaging uses antibody markers to identify protein in tissue samples.</li>
<li>The protein Beta-catenin is known to be higher in tumor cells.</li>
</ul>
<center>
<div class="float" id="section-id">
<img src="figures/B_CATENIN.jpg" class="class" style="width:60.0%;height:60.0%" alt="beta catenin image" />
<div class="figcaption">beta catenin image</div>
</div>
</center>
</div>
<div id="section-mif-imaging-in-a-statistical-framework" class="section level3 hasAnchor" number="2.5.11">
<h3><span class="header-section-number">2.5.11</span> mIF imaging in a statistical framework<a href="section-probability.html#section-mif-imaging-in-a-statistical-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we want to ask the question, “What is the mean concentration of Beta-catenin in the cells from a given tissue sample?”</p>
<ol style="list-style-type: decimal">
<li>What is my parameter of interest (target parameter)?
<ul>
<li>Mean cellular concentration of Beta-catenin <span class="math inline">\(\mathbb{E}X_i\)</span></li>
</ul></li>
<li>What is my population of interest?
<ul>
<li>All possible cells from the given tumor (potentially)?</li>
<li>All possible cells from similar tumors?</li>
</ul></li>
<li>What is a data point?
<ul>
<li>A single cell</li>
</ul></li>
<li>What model can I use to describe how I get a data point?
<ul>
<li>That’s a good question. Here is the histogram of the data</li>
</ul></li>
</ol>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb27-1"><a href="section-probability.html#section-cb27-1" tabindex="-1"></a>bc <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&#39;../datasets/betaCatenin.rds&#39;</span>)</span>
<span id="section-cb27-2"><a href="section-probability.html#section-cb27-2" tabindex="-1"></a><span class="fu">hist</span>(bc, <span class="at">main=</span><span class="st">&#39;Beta Catenin Histogram&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Marker count&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="576" />
+ The Beta-catenin concentration across cells could be modeled with a Gamma distribution.</p>
</div>
<div id="section-a-gamma-model-for-beta-catenin-concentration" class="section level3 hasAnchor" number="2.5.12">
<h3><span class="header-section-number">2.5.12</span> A Gamma model for Beta-catenin concentration<a href="section-probability.html#section-a-gamma-model-for-beta-catenin-concentration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Previously, we defined the parameter of interest <span class="math inline">\(p\)</span> based on what we were interested in the alcohol problem and it also happened to be the parameter of the Bernoulli distribution.</p></li>
<li><p>In this example that is not the case.</p></li>
<li><p>Let <span class="math inline">\(X_i\)</span> denote a randomly drawn cell from the tissue image.</p></li>
<li><p>Assume <span class="math inline">\(X_i \sim \text{Gamma}(\alpha, \beta)\)</span>.</p></li>
<li><p>Let’s consider three parameters</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{E}X_i = \alpha/\beta\)</span></li>
<li><span class="math inline">\(\alpha\)</span> (shape parameter)</li>
<li><span class="math inline">\(\beta\)</span> (rate parameter)</li>
</ol></li>
</ul>
<p>Let’s assess estimators for each of these parameters.</p>
</div>
<div id="section-mxif-example-estimators" class="section level3 hasAnchor" number="2.5.13">
<h3><span class="header-section-number">2.5.13</span> MxIF example: Estimators<a href="section-probability.html#section-mxif-example-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I used method of moments (which you’ll learn in another class) to obtain estimators for these parameters.
The estimators are
<span class="math display">\[
\begin{align*}
\hat \mu &amp; = \bar X = n^{-1} \sum_{i=1}^n X_i \\
\tilde \alpha &amp; = \frac{\bar X^2}{\left(\overline{X^2} - \bar X^2\right)} \\
\tilde \beta &amp; = \frac{\bar X}{\left(\overline{X^2} - \bar X^2\right)}
\end{align*}
\]</span></p>
<ul>
<li><span class="math inline">\(\tilde \alpha\)</span> and <span class="math inline">\(\tilde \beta\)</span> are complicated functions of random variables involving ratios.</li>
<li>It might be hard to find their bias. It will definitely be hard to find their variance.</li>
<li>Instead, let’s use simulations to assess the bias, variance, and MSE of these estimators.</li>
</ul>
</div>
<div id="section-concept-of-simulation-study" class="section level3 hasAnchor" number="2.5.14">
<h3><span class="header-section-number">2.5.14</span> Concept of simulation study<a href="section-probability.html#section-concept-of-simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The bias, variance, and MSE are defined with respect to distribution of the test statistic across repeated samples of the data.</li>
<li>If I can repeat the experiment in <code>R</code> multiple times, then I can see multiple random versions of the estimator.</li>
<li>A simulation is an experiment to study what happens across experiments.</li>
</ul>
</div>
<div id="section-simulation-study" class="section level3 hasAnchor" number="2.5.15">
<h3><span class="header-section-number">2.5.15</span> Simulation study<a href="section-probability.html#section-simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb28-1"><a href="section-probability.html#section-cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="section-cb28-2"><a href="section-probability.html#section-cb28-2" tabindex="-1"></a><span class="co"># number simulation</span></span>
<span id="section-cb28-3"><a href="section-probability.html#section-cb28-3" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="section-cb28-4"><a href="section-probability.html#section-cb28-4" tabindex="-1"></a><span class="co"># sample sizes</span></span>
<span id="section-cb28-5"><a href="section-probability.html#section-cb28-5" tabindex="-1"></a>ns <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>)</span>
<span id="section-cb28-6"><a href="section-probability.html#section-cb28-6" tabindex="-1"></a><span class="co"># values of alpha to consider</span></span>
<span id="section-cb28-7"><a href="section-probability.html#section-cb28-7" tabindex="-1"></a>alphas <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">5</span>)</span>
<span id="section-cb28-8"><a href="section-probability.html#section-cb28-8" tabindex="-1"></a><span class="co"># values of beta to consider</span></span>
<span id="section-cb28-9"><a href="section-probability.html#section-cb28-9" tabindex="-1"></a>betas <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="dv">3</span>)</span>
<span id="section-cb28-10"><a href="section-probability.html#section-cb28-10" tabindex="-1"></a></span>
<span id="section-cb28-11"><a href="section-probability.html#section-cb28-11" tabindex="-1"></a><span class="co"># presults = data.frame(p=ps, biasmuHat = rep(NA, np), biassigmaSqHat=rep(NA, np), biassigmaSqHat2=rep(NA, np),</span></span>
<span id="section-cb28-12"><a href="section-probability.html#section-cb28-12" tabindex="-1"></a><span class="co">#                       varmuHat=rep(NA, np), varsigmaSqHat=rep(NA, np), varsigmaSqHat2=rep(NA, np))</span></span>
<span id="section-cb28-13"><a href="section-probability.html#section-cb28-13" tabindex="-1"></a></span>
<span id="section-cb28-14"><a href="section-probability.html#section-cb28-14" tabindex="-1"></a>presults <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> alphas, <span class="at">beta=</span>betas, <span class="at">n=</span>ns)</span>
<span id="section-cb28-15"><a href="section-probability.html#section-cb28-15" tabindex="-1"></a>colNames <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;muHat&#39;</span>, <span class="st">&#39;alphaTilde&#39;</span>, <span class="st">&#39;betaTilde&#39;</span>), <span class="at">each=</span><span class="dv">3</span>),</span>
<span id="section-cb28-16"><a href="section-probability.html#section-cb28-16" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Bias&#39;</span>, <span class="st">&#39;Variance&#39;</span>, <span class="st">&#39;MSE&#39;</span>), <span class="dv">3</span>))</span>
<span id="section-cb28-17"><a href="section-probability.html#section-cb28-17" tabindex="-1"></a>presults[, colNames ] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="section-cb28-18"><a href="section-probability.html#section-cb28-18" tabindex="-1"></a></span>
<span id="section-cb28-19"><a href="section-probability.html#section-cb28-19" tabindex="-1"></a>alphaind <span class="ot">=</span> <span class="dv">1</span>; betaind <span class="ot">=</span> <span class="dv">2</span>; nind <span class="ot">=</span> <span class="dv">3</span></span>
<span id="section-cb28-20"><a href="section-probability.html#section-cb28-20" tabindex="-1"></a><span class="co"># loops through the parameter values</span></span>
<span id="section-cb28-21"><a href="section-probability.html#section-cb28-21" tabindex="-1"></a><span class="cf">for</span>(alphaind <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alphas) ){</span>
<span id="section-cb28-22"><a href="section-probability.html#section-cb28-22" tabindex="-1"></a>  <span class="cf">for</span>(betaind <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(betas)){</span>
<span id="section-cb28-23"><a href="section-probability.html#section-cb28-23" tabindex="-1"></a>    </span>
<span id="section-cb28-24"><a href="section-probability.html#section-cb28-24" tabindex="-1"></a>      <span class="co"># data generating distribution parameters (for the gamma distribution)</span></span>
<span id="section-cb28-25"><a href="section-probability.html#section-cb28-25" tabindex="-1"></a>      alpha <span class="ot">=</span> alphas[alphaind]</span>
<span id="section-cb28-26"><a href="section-probability.html#section-cb28-26" tabindex="-1"></a>      beta <span class="ot">=</span> betas[betaind]</span>
<span id="section-cb28-27"><a href="section-probability.html#section-cb28-27" tabindex="-1"></a>      </span>
<span id="section-cb28-28"><a href="section-probability.html#section-cb28-28" tabindex="-1"></a>    <span class="cf">for</span>(nind <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ns)){</span>
<span id="section-cb28-29"><a href="section-probability.html#section-cb28-29" tabindex="-1"></a>      <span class="co"># get n for this simulation setting</span></span>
<span id="section-cb28-30"><a href="section-probability.html#section-cb28-30" tabindex="-1"></a>      n <span class="ot">=</span> ns[nind]</span>
<span id="section-cb28-31"><a href="section-probability.html#section-cb28-31" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">which</span>(presults<span class="sc">$</span>n<span class="sc">==</span>n <span class="sc">&amp;</span> presults<span class="sc">$</span>alpha<span class="sc">==</span>alpha <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span> beta), <span class="st">&#39;</span><span class="sc">\t</span><span class="st">&#39;</span>)</span>
<span id="section-cb28-32"><a href="section-probability.html#section-cb28-32" tabindex="-1"></a>      </span>
<span id="section-cb28-33"><a href="section-probability.html#section-cb28-33" tabindex="-1"></a>      <span class="co"># loops through the simulations</span></span>
<span id="section-cb28-34"><a href="section-probability.html#section-cb28-34" tabindex="-1"></a>      <span class="co"># each simulation is one realization of the world</span></span>
<span id="section-cb28-35"><a href="section-probability.html#section-cb28-35" tabindex="-1"></a>      results <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">muHat =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim), <span class="at">alphaTilde=</span><span class="fu">rep</span>(<span class="cn">NA</span>, nsim), <span class="at">betaTilde=</span><span class="fu">rep</span>(<span class="cn">NA</span>, nsim) )</span>
<span id="section-cb28-36"><a href="section-probability.html#section-cb28-36" tabindex="-1"></a>      <span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="section-cb28-37"><a href="section-probability.html#section-cb28-37" tabindex="-1"></a>        </span>
<span id="section-cb28-38"><a href="section-probability.html#section-cb28-38" tabindex="-1"></a>        <span class="co"># sample a data set of size n from some random variable</span></span>
<span id="section-cb28-39"><a href="section-probability.html#section-cb28-39" tabindex="-1"></a>        x <span class="ot">=</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>alpha, <span class="at">rate=</span>beta)</span>
<span id="section-cb28-40"><a href="section-probability.html#section-cb28-40" tabindex="-1"></a>        </span>
<span id="section-cb28-41"><a href="section-probability.html#section-cb28-41" tabindex="-1"></a>        <span class="co"># compute estimators</span></span>
<span id="section-cb28-42"><a href="section-probability.html#section-cb28-42" tabindex="-1"></a>        muHat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="section-cb28-43"><a href="section-probability.html#section-cb28-43" tabindex="-1"></a>        alphaTilde <span class="ot">=</span> muHat<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="section-cb28-44"><a href="section-probability.html#section-cb28-44" tabindex="-1"></a>        betaTilde <span class="ot">=</span> muHat <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="section-cb28-45"><a href="section-probability.html#section-cb28-45" tabindex="-1"></a>        <span class="co">#sigmaSqHat = sum((x-mean(x))^2)/(length(x)-1)</span></span>
<span id="section-cb28-46"><a href="section-probability.html#section-cb28-46" tabindex="-1"></a>        </span>
<span id="section-cb28-47"><a href="section-probability.html#section-cb28-47" tabindex="-1"></a>        results[sim, <span class="fu">c</span>(<span class="st">&#39;muHat&#39;</span>, <span class="st">&#39;alphaTilde&#39;</span>, <span class="st">&#39;betaTilde&#39;</span>) ] <span class="ot">=</span> <span class="fu">c</span>(muHat, alphaTilde, betaTilde)</span>
<span id="section-cb28-48"><a href="section-probability.html#section-cb28-48" tabindex="-1"></a>      } <span class="co"># end of the nsim loop</span></span>
<span id="section-cb28-49"><a href="section-probability.html#section-cb28-49" tabindex="-1"></a>      </span>
<span id="section-cb28-50"><a href="section-probability.html#section-cb28-50" tabindex="-1"></a>      <span class="co"># saving the results for each value of p</span></span>
<span id="section-cb28-51"><a href="section-probability.html#section-cb28-51" tabindex="-1"></a>      <span class="co">#presults[pind, c(&#39;biasmuHat&#39;, &#39;biassigmaSqHat&#39;, &#39;biasSigmaSqHat2&#39;)] = colMeans(results) - c(p, p*(1-p), p*(1-p))</span></span>
<span id="section-cb28-52"><a href="section-probability.html#section-cb28-52" tabindex="-1"></a>      <span class="co">#presults[pind, c(&#39;varmuHat&#39;, &#39;varsigmaSqHat&#39;, &#39;varSigmaSqHat2&#39;)] = diag(var(results))</span></span>
<span id="section-cb28-53"><a href="section-probability.html#section-cb28-53" tabindex="-1"></a>      </span>
<span id="section-cb28-54"><a href="section-probability.html#section-cb28-54" tabindex="-1"></a>      <span class="co"># Bias variance MSE for muHat</span></span>
<span id="section-cb28-55"><a href="section-probability.html#section-cb28-55" tabindex="-1"></a>      presults[ <span class="fu">which</span>(presults<span class="sc">$</span>n<span class="sc">==</span>n <span class="sc">&amp;</span> presults<span class="sc">$</span>alpha<span class="sc">==</span>alpha <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span> beta), <span class="fu">c</span>(<span class="st">&#39;muHat Bias&#39;</span>, <span class="st">&#39;muHat Variance&#39;</span>, <span class="st">&#39;muHat MSE&#39;</span>)] <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(results<span class="sc">$</span>muHat) <span class="sc">-</span> alpha<span class="sc">/</span>beta,</span>
<span id="section-cb28-56"><a href="section-probability.html#section-cb28-56" tabindex="-1"></a>                                                                <span class="fu">var</span>(results<span class="sc">$</span>muHat),</span>
<span id="section-cb28-57"><a href="section-probability.html#section-cb28-57" tabindex="-1"></a>                                                                (<span class="fu">mean</span>(results<span class="sc">$</span>muHat) <span class="sc">-</span> alpha<span class="sc">/</span>beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">var</span>(results<span class="sc">$</span>muHat) )</span>
<span id="section-cb28-58"><a href="section-probability.html#section-cb28-58" tabindex="-1"></a>      presults[ <span class="fu">which</span>(presults<span class="sc">$</span>n<span class="sc">==</span>n <span class="sc">&amp;</span> presults<span class="sc">$</span>alpha<span class="sc">==</span>alpha <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span> beta), <span class="fu">c</span>(<span class="st">&#39;alphaTilde Bias&#39;</span>, <span class="st">&#39;alphaTilde Variance&#39;</span>, <span class="st">&#39;alphaTilde MSE&#39;</span>)] <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(results<span class="sc">$</span>alphaTilde) <span class="sc">-</span> alpha,</span>
<span id="section-cb28-59"><a href="section-probability.html#section-cb28-59" tabindex="-1"></a>                                                                <span class="fu">var</span>(results<span class="sc">$</span>alphaTilde),</span>
<span id="section-cb28-60"><a href="section-probability.html#section-cb28-60" tabindex="-1"></a>                                                                (<span class="fu">mean</span>(results<span class="sc">$</span>alphaTilde) <span class="sc">-</span> alpha)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">var</span>(results<span class="sc">$</span>alphaTilde) )</span>
<span id="section-cb28-61"><a href="section-probability.html#section-cb28-61" tabindex="-1"></a>      presults[ <span class="fu">which</span>(presults<span class="sc">$</span>n<span class="sc">==</span>n <span class="sc">&amp;</span> presults<span class="sc">$</span>alpha<span class="sc">==</span>alpha <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span> beta), <span class="fu">c</span>(<span class="st">&#39;betaTilde Bias&#39;</span>, <span class="st">&#39;betaTilde Variance&#39;</span>, <span class="st">&#39;betaTilde MSE&#39;</span>)] <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(results<span class="sc">$</span>betaTilde) <span class="sc">-</span> beta,</span>
<span id="section-cb28-62"><a href="section-probability.html#section-cb28-62" tabindex="-1"></a>                                                                <span class="fu">var</span>(results<span class="sc">$</span>betaTilde),</span>
<span id="section-cb28-63"><a href="section-probability.html#section-cb28-63" tabindex="-1"></a>                                                                (<span class="fu">mean</span>(results<span class="sc">$</span>betaTilde) <span class="sc">-</span> beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">var</span>(results<span class="sc">$</span>betaTilde) )</span>
<span id="section-cb28-64"><a href="section-probability.html#section-cb28-64" tabindex="-1"></a>    } <span class="co"># loop through ns</span></span>
<span id="section-cb28-65"><a href="section-probability.html#section-cb28-65" tabindex="-1"></a>  } <span class="co"># loop through the betas</span></span>
<span id="section-cb28-66"><a href="section-probability.html#section-cb28-66" tabindex="-1"></a>} <span class="co"># loop through the alphas</span></span></code></pre></div>
</details>
<pre><code>## 1    5   9   13  17  21  3   7   11  15  19  23  2   6   10  14  18  22  4   8   12  16  20  24  </code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb30-1"><a href="section-probability.html#section-cb30-1" tabindex="-1"></a>subres <span class="ot">=</span> presults[ presults<span class="sc">$</span>alpha<span class="sc">==</span><span class="fl">0.5</span> <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span><span class="fl">0.25</span>,]</span>
<span id="section-cb30-2"><a href="section-probability.html#section-cb30-2" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="section-cb30-3"><a href="section-probability.html#section-cb30-3" tabindex="-1"></a></span>
<span id="section-cb30-4"><a href="section-probability.html#section-cb30-4" tabindex="-1"></a><span class="co"># Bias plots</span></span>
<span id="section-cb30-5"><a href="section-probability.html#section-cb30-5" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;muHat Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-6"><a href="section-probability.html#section-cb30-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb30-7"><a href="section-probability.html#section-cb30-7" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;alphaTilde Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-8"><a href="section-probability.html#section-cb30-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb30-9"><a href="section-probability.html#section-cb30-9" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;betaTilde Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-10"><a href="section-probability.html#section-cb30-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb30-11"><a href="section-probability.html#section-cb30-11" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;muHat Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-12"><a href="section-probability.html#section-cb30-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb30-13"><a href="section-probability.html#section-cb30-13" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;alphaTilde Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-14"><a href="section-probability.html#section-cb30-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb30-15"><a href="section-probability.html#section-cb30-15" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;betaTilde Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb30-16"><a href="section-probability.html#section-cb30-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="864" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb31-1"><a href="section-probability.html#section-cb31-1" tabindex="-1"></a>subres <span class="ot">=</span> presults[ presults<span class="sc">$</span>alpha<span class="sc">==</span><span class="dv">5</span> <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span><span class="dv">3</span>,]</span>
<span id="section-cb31-2"><a href="section-probability.html#section-cb31-2" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="section-cb31-3"><a href="section-probability.html#section-cb31-3" tabindex="-1"></a></span>
<span id="section-cb31-4"><a href="section-probability.html#section-cb31-4" tabindex="-1"></a><span class="co"># Bias plots</span></span>
<span id="section-cb31-5"><a href="section-probability.html#section-cb31-5" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;muHat Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-6"><a href="section-probability.html#section-cb31-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb31-7"><a href="section-probability.html#section-cb31-7" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;alphaTilde Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-8"><a href="section-probability.html#section-cb31-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb31-9"><a href="section-probability.html#section-cb31-9" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;betaTilde Bias&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Bias of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-10"><a href="section-probability.html#section-cb31-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb31-11"><a href="section-probability.html#section-cb31-11" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;muHat Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-12"><a href="section-probability.html#section-cb31-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb31-13"><a href="section-probability.html#section-cb31-13" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;alphaTilde Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-14"><a href="section-probability.html#section-cb31-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb31-15"><a href="section-probability.html#section-cb31-15" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;betaTilde Variance&#39;</span>], <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Variance&#39;</span>, <span class="at">main=</span><span class="st">&#39;Variance of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb31-16"><a href="section-probability.html#section-cb31-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-21-2.png" width="864" /></p>
<ul>
<li>Percent bias instead of raw bias</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb32-1"><a href="section-probability.html#section-cb32-1" tabindex="-1"></a>subres <span class="ot">=</span> presults[ presults<span class="sc">$</span>alpha<span class="sc">==</span><span class="fl">0.5</span> <span class="sc">&amp;</span> presults<span class="sc">$</span>beta <span class="sc">==</span><span class="fl">0.25</span>,]</span>
<span id="section-cb32-2"><a href="section-probability.html#section-cb32-2" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="section-cb32-3"><a href="section-probability.html#section-cb32-3" tabindex="-1"></a></span>
<span id="section-cb32-4"><a href="section-probability.html#section-cb32-4" tabindex="-1"></a><span class="co"># Bias plots</span></span>
<span id="section-cb32-5"><a href="section-probability.html#section-cb32-5" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;muHat Bias&#39;</span>]<span class="sc">/</span>(subres[,<span class="st">&#39;alpha&#39;</span>]<span class="sc">/</span>subres[,<span class="st">&#39;beta&#39;</span>]), <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Percent bias of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-6"><a href="section-probability.html#section-cb32-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb32-7"><a href="section-probability.html#section-cb32-7" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;alphaTilde Bias&#39;</span>]<span class="sc">/</span>subres[,<span class="st">&#39;alpha&#39;</span>]<span class="sc">*</span><span class="dv">100</span>, <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Percent bias of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-8"><a href="section-probability.html#section-cb32-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb32-9"><a href="section-probability.html#section-cb32-9" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, subres[, <span class="st">&#39;betaTilde Bias&#39;</span>]<span class="sc">/</span>subres[,<span class="st">&#39;beta&#39;</span>]<span class="sc">*</span><span class="dv">100</span>, <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Bias&#39;</span>, <span class="at">main=</span><span class="st">&#39;Percent bias of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-10"><a href="section-probability.html#section-cb32-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb32-11"><a href="section-probability.html#section-cb32-11" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, <span class="fu">sqrt</span>(subres[, <span class="st">&#39;muHat Variance&#39;</span>])<span class="sc">/</span>(subres[,<span class="st">&#39;alpha&#39;</span>]<span class="sc">/</span>subres[,<span class="st">&#39;beta&#39;</span>])<span class="sc">*</span><span class="dv">100</span>, <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Percentage&#39;</span>, <span class="at">main=</span><span class="st">&#39;Percent SE of muHat&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-12"><a href="section-probability.html#section-cb32-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb32-13"><a href="section-probability.html#section-cb32-13" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, <span class="fu">sqrt</span>(subres[, <span class="st">&#39;alphaTilde Variance&#39;</span>])<span class="sc">/</span>subres[,<span class="st">&#39;alpha&#39;</span>]<span class="sc">*</span><span class="dv">100</span>, <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Percentage&#39;</span>, <span class="at">main=</span><span class="st">&#39;percent SE of alphaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-14"><a href="section-probability.html#section-cb32-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="section-cb32-15"><a href="section-probability.html#section-cb32-15" tabindex="-1"></a><span class="fu">plot</span>(subres<span class="sc">$</span>n, <span class="fu">sqrt</span>(subres[, <span class="st">&#39;betaTilde Variance&#39;</span>])<span class="sc">/</span>subres[,<span class="st">&#39;beta&#39;</span>]<span class="sc">*</span><span class="dv">100</span>, <span class="at">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Percentage&#39;</span>, <span class="at">main=</span><span class="st">&#39;percent SE of betaTilde&#39;</span>, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="section-cb32-16"><a href="section-probability.html#section-cb32-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="864" /></p>
</div>
<div id="section-assessing-estimators-in-the-homework" class="section level3 hasAnchor" number="2.5.16">
<h3><span class="header-section-number">2.5.16</span> Assessing estimators in the homework<a href="section-probability.html#section-assessing-estimators-in-the-homework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>I left more interesting problems for you to do in the homework.</li>
<li>There, you will compare two estimators for the same parameter, and pick which one you think is better.</li>
</ul>
</div>
<div id="section-mxif-example-estimate" class="section level3 flexbox vcenter hasAnchor" number="2.5.17">
<h3><span class="header-section-number">2.5.17</span> MxIF example: Estimate<a href="section-probability.html#section-mxif-example-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The estimates in the real data are <span class="math inline">\(\hat\mu=\)</span><code>3985.4</code>, <span class="math inline">\(\tilde\alpha=\)</span><code>8.7</code>, and <span class="math inline">\(\tilde\beta=\)</span><code>0.002</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="section-cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb33-1"><a href="section-probability.html#section-cb33-1" tabindex="-1"></a>bc <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&#39;../datasets/betaCatenin.rds&#39;</span>)</span>
<span id="section-cb33-2"><a href="section-probability.html#section-cb33-2" tabindex="-1"></a>alphaTilde <span class="ot">=</span> <span class="fu">mean</span>(bc)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">var</span>(bc)</span>
<span id="section-cb33-3"><a href="section-probability.html#section-cb33-3" tabindex="-1"></a>betaTilde <span class="ot">=</span> <span class="fu">mean</span>(bc)<span class="sc">/</span><span class="fu">var</span>(bc)</span>
<span id="section-cb33-4"><a href="section-probability.html#section-cb33-4" tabindex="-1"></a></span>
<span id="section-cb33-5"><a href="section-probability.html#section-cb33-5" tabindex="-1"></a></span>
<span id="section-cb33-6"><a href="section-probability.html#section-cb33-6" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="fu">min</span>(bc), <span class="at">to=</span><span class="fu">max</span>(bc), <span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="section-cb33-7"><a href="section-probability.html#section-cb33-7" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dgamma</span>(x, <span class="at">shape=</span>alphaTilde, <span class="at">rate=</span>betaTilde)</span>
<span id="section-cb33-8"><a href="section-probability.html#section-cb33-8" tabindex="-1"></a><span class="fu">hist</span>(bc, <span class="at">main=</span><span class="st">&#39;Beta Catenin Histogram&#39;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">&#39;Marker count&#39;</span>, <span class="at">ylim=</span><span class="fu">range</span>(y))</span>
<span id="section-cb33-9"><a href="section-probability.html#section-cb33-9" tabindex="-1"></a><span class="fu">points</span>(x, y, <span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" width="576" />

<script type="application/shiny-prerendered" data-context="server-start">
knitr::knit_hooks$set(GPs=function(before, options, envir){
if (before){
  cex=1.5
par(mgp=c(1.7,.7,0), lwd=1.5, lend=2,
    cex.lab=0.8*cex, cex.axis=0.8*cex, cex.main=1*cex,
    mar=c(2.8,2.8,1.8,.2), bty='l', oma=c(0,0,2,0))}
})
knitr::opts_chunk$set(echo = TRUE, fig.height = 3, fig.width = 3, cache=FALSE, GPs=TRUE)
set.seed(100)

cols = c('black', RColorBrewer::brewer.pal(9, 'Set1'))
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>


<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-filter1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-filter1-code-editor`)), session)
output$`tutorial-exercise-filter1-output` <- renderUI({
  `tutorial-exercise-filter1-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "filter1", global_setup = structure(c("knitr::knit_hooks$set(GPs=function(before, options, envir){", 
"if (before){", "  cex=1.5", "par(mgp=c(1.7,.7,0), lwd=1.5, lend=2,", 
"    cex.lab=0.8*cex, cex.axis=0.8*cex, cex.main=1*cex,", "    mar=c(2.8,2.8,1.8,.2), bty='l', oma=c(0,0,2,0))}", 
"})", "knitr::opts_chunk$set(echo = TRUE, fig.height = 3, fig.width = 3, cache=FALSE, GPs=TRUE)", 
"set.seed(100)", "", "cols = c('black', RColorBrewer::brewer.pal(9, 'Set1'))"
), chunk_opts = list(label = "setup", echo = FALSE, cache = FALSE, 
    message = FALSE)), setup = NULL, chunks = list(list(label = "filter1", 
    code = "insurance", opts = list(label = "\"filter1\"", exercise = "TRUE", 
        exercise.eval = "FALSE"), engine = "r")), code_check = NULL, 
    error_check = NULL, check = NULL, solution = NULL, tests = NULL, 
    options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "index_cache/html/", cache.vars = NULL, 
        cache.lazy = TRUE, dependson = NULL, autodep = FALSE, 
        cache.rebuild = FALSE, fig.keep = "high", fig.show = "asis", 
        fig.align = "default", fig.path = "index_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 3, fig.height = 3, fig.env = "figure", fig.cap = NULL, 
        fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 288, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = TRUE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        GPs = TRUE, label = "filter1", exercise = TRUE, exercise.eval = FALSE, 
        code = "insurance", out.width.px = 288, out.height.px = 288, 
        params.src = "filter1, exercise = TRUE, exercise.eval = FALSE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["fuse"]},{"type":"character","attributes":{},"value":["6.4.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href"]}},"value":[{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["dist/fuse.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["gitbook"]},{"type":"character","attributes":{},"value":["2.6.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["resources/gitbook"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/app.min.js","js/clipboard.min.js","js/plugin-search.js","js/plugin-sharing.js","js/plugin-fontsettings.js","js/plugin-bookdown.js","js/jquery.highlight.js","js/plugin-clipboard.js"]},{"type":"character","attributes":{},"value":["css/style.css","css/plugin-table.css","css/plugin-bookdown.css","css/plugin-highlight.css","css/plugin-search.css","css/plugin-fontsettings.css","css/plugin-clipboard.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bookdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.34"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["codefolding-lua"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["codefolding-lua.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["anchor-sections"]},{"type":"character","attributes":{},"value":["1.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/anchor-sections"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["anchor-sections.js"]},{"type":"character","attributes":{},"value":["anchor-sections.css","anchor-sections-hash.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106]}},"value":[{"type":"character","attributes":{},"value":["abind","aod","base","bookdown","boot","bslib","cachem","car","carData","cli","clubSandwich","codetools","colorspace","compiler","crayon","data.table","datasets","digest","dplyr","ellipsis","evaluate","fansi","fastmap","float","FNN","fontawesome","forcats","foreach","generics","ggplot2","glmnet","glue","graphics","grDevices","grid","gtable","gtools","highr","hms","htmltools","htmlwidgets","httpuv","iterators","jquerylib","jsonlite","knitr","later","lattice","learnr","lgr","lifecycle","lmtest","lubridate","magrittr","MASS","Matrix","methods","mime","mlapi","munsell","mvtnorm","nlme","parallel","pillar","pkgconfig","promises","purrr","R6","RColorBrewer","Rcpp","readr","regtools","RESI","RhpcBLASctl","rje","rlang","rmarkdown","rprojroot","rsparse","rstudioapi","sandwich","sass","scales","shape","shiny","splines","stats","stringi","stringr","survival","text2vec","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","withr","xfun","xtable","yaml","zoo"]},{"type":"character","attributes":{},"value":["1.4-5","1.3.2","4.3.1","0.34","1.3-28.1","0.5.0","1.0.8","3.1-2","3.0-5","3.6.1","0.5.10","0.2-19","2.1-0","4.3.1","1.5.2","1.14.8","4.3.1","0.6.33","1.1.2","0.3.2","0.21","1.0.4","1.1.1","0.3-1","1.1.3.2","0.5.1","1.0.0","1.5.2","0.1.3","3.4.2","4.1-7","1.6.2","4.3.1","4.3.1","4.3.1","0.3.3","3.9.4","0.10","1.1.3","0.5.5","1.6.2","1.6.11","1.0.14","0.1.4","1.8.7","1.43","1.3.1","0.21-8","0.11.4","0.4.4","1.0.3","0.9-40","1.9.2","2.0.3","7.3-60","1.6-0","4.3.1","0.12","0.1.1","0.5.0","1.2-2","3.1-162","4.3.1","1.9.0","2.0.3","1.2.0.1","1.0.1","2.5.1","1.1-3","1.0.11","2.1.4","1.7.0","1.2.0","0.23-42","1.12.1","1.1.1","2.23","2.0.3","0.5.1","0.15.0","3.0-2","0.4.7","1.2.1","1.4.6","1.7.4.1","4.3.1","4.3.1","1.7.12","1.5.0","3.5-5","0.6.3","3.2.1","1.3.0","1.2.0","2.0.0","0.2.0","4.3.1","0.4.0","1.2.3","4.3.1","0.6.3","2.5.0","0.39","1.8-4","2.3.7","1.8-12"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-r-and-how-to-follow-along-in-this-class.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
